window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.core.instantsearch.js'] = (new Date()).getTime();
Type.registerNamespace("_is");_is.bf=function(){};_is.bf.registerInterface("_is.bf");_is.W=function(){_is.W.initializeBase(this);this.c=0;this.b=_a.d.a();this.a=_a.d.a()};_is.W.prototype={b:null,a:null,c:0,e:!1,d:!1,f:!1,j:function(n){if(this.c!==n){this.c=n;this.bw("SelectedDateRange");this.g();this.n(n===4);n===4||this.d||this.bw("TriggerSearch")}return n},n:function(n){if(this.e!==n){this.e=n;this.bw("IsCustomDatePickerEnabled")}return n},m:function(n){if(this.b!==n){this.b=n;this.bw("DateRangeStart");if(this.a.b(this.b)>=0){this.g();this.bw("TriggerSearch")}}return n},l:function(n){if(this.a!==n){this.a=n;this.bw("DateRangeEnd");if(this.a.b(this.b)>=0){this.g();this.bw("TriggerSearch")}}return n},i:function(n){if(this.f!==n){this.f=n;this.bw("IsHidden")}return n},k:function(){if(!this.c)return null;var n=_a.d.a();var t=_a.d.a();switch(this.c){case 1:n=_a.d.a().c(1).d();t=_a.d.e(_a.d.a(),1).d();break;case 2:n=_a.d.e(_a.d.a(),1).d();t=n.c(-7);break;case 3:n=_a.d.a().c(1).d();t=new _a.d(n.g(),n.f(),1);break;case 4:n=this.a.c(1).d();t=this.b;break;default:break}var u,f,i;var c=(i=new _g.dy,i.Item=new _g.d("DateTimeReceived"),i.FieldURIOrConstant=(f=new _g.U,f.Item=(u=new _g.T,u.Value=n.z(),u),f),i);var e,o,r;var l=(r=new _dg.bq,r.Item=new _g.d("DateTimeReceived"),r.FieldURIOrConstant=(o=new _g.U,o.Item=(e=new _g.T,e.Value=t.z(),e),o),r);var s,h;return h=new _g.bd,h.Item=(s=new _gg.ds,s.Items=[c,l],s),h},h:function(){this.d=!0;this.j(0);this.d=!1},g:function(){if(!this.d){var n=_a.c.b(_a.a.t,"InstantSearchRefinerSelected",!1,null);n.m=String.format("RefinerType:{0};Selected:{1}","CustomDateRefiner","True");_a.c.a(n)}}};_is.bx=function(n,t,i){_is.bx.initializeBase(this,[n,"FolderRefiner"]);this.c=i};_is.bx.prototype={e:0,g:1,c:null,d:null,a:0,h:function(n){this.d=n;var t=_g.b.a;var i=n.bD.FolderId.Id;if(i!==t.nameToId("inbox").Id&&i!==t.nameToId("msgfolderroot").Id&&!(t.nameToId("archivemsgfolderroot")&&i===t.nameToId("archivemsgfolderroot").Id)&&!this.f(this.o(),n.bD.FolderId)){var r=new _is.f(n.bD.FolderId,1,n.bD.DisplayName,0,null,!1,null);this.o().r(this.a,r);this.a++;this.u=!0;var u=this.e;this.o().a(u).v=!1;r.v=!0;this.p(r);this.u=!1}},x:function(n){if(this.b()){var s=this.b();if(s.w!==2){for(var t=new _j.q,i=0;i<this.o().b();i++){var e=this.o().a(i);e.w===2&&t.c(e)}for(var r=0;r<t.d.length;r++)this.o().k(t.d[r]);this.o().b()>4;if(n){for(var u=new _j.q,f=0;f<n.x.length&&this.o().b()<5;f++){var o=n.x[f];this.f(this.o(),o.a)||u.c(o)}u.d.length>0&&this.o().G(this.a,u.i())}}}},j:function(n){this.i(n)},m:function(n){var t=n?"archivemsgfolderroot":"msgfolderroot";return this.b()?_is.g.isInstanceOfType(this.b())?this.b().K():_g.b.a.nameToId(t):_g.b.a.nameToId(t)},l:function(){return this.b()?_is.g.isInstanceOfType(this.b())?this.b().T():_u.R.i:_u.R.i},r:function(){return this.b()?_is.g.isInstanceOfType(this.b())?this.b().L():null:null},B:function(n,t,i,r){var u=_is.bP.prototype.B.call(this,n,t,i,r);return String.format("{0};OrigFolder:{1}",u,this.q())},f:function(n,t){for(var i=0;i<n.b();i++)if(_is.f.isInstanceOfType(n.a(i))){var r=n.a(i);if(r.a.Id===t.Id)return!0}return!1},i:function(n){var f=_g.b.a;var s=n?"archivemsgfolderroot":"msgfolderroot";var r=new _is.f(f.nameToId(s),1,_u.R.i,0,null,!1,null);var t=new _a.k;t.r(this.e,r);this.a=1;if(!n){var u=f.nameToId("inbox");var e=_h.a.e(u);if(!e)return;var h=new _is.f(u,1,e.f(u).bD.DisplayName,0,null,!1,null);t.r(this.g,h);this.a++}var i=this;var o=function(){i.v(t);i.u=!0;r.v=!0;i.p(r);i.u=!1};if(this.c){var c=this;this.c.c(function(n){var i=n.b(2,1);i&&t.r(c.a,i);o()},!1)}else o()},q:function(){return this.d?_g.j.g(this.d):""}};_is.f=function(n,t,i,r,u,f,e){_is.f.initializeBase(this,[t,i,r,u,f,e]);this.a=n;this.y=1};_is.f.prototype={a:null,K:function(){return this.w===1?this.a:_h.n.a(this.a)?_g.b.a.nameToId("archivemsgfolderroot"):_g.b.a.nameToId("msgfolderroot")},L:function(){return this.w===2?this.p:null},t:function(){var n=_h.a.a(this.a);return _g.j.g(n)}};_is.u=function(){};_is.u.prototype={b:function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y){return new _is.n(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,200,-1)},a:function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p){return new _is.n(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,200,p)}};_is.by=function(n,t,i,r,u,f,e,o,s,h){this.u=n;this.m=t;this.r=i;this.n=new _is.B;this.i=new _a.bF(5);this.k=new _a.bF(5);this.j=r;this.t=u;this.o=f;this.l=e;this.s=o;this.q=s;this.p=h};_is.by.prototype={m:null,o:null,u:null,i:null,r:null,t:null,l:null,s:null,q:null,p:null,n:null,k:null,j:null,h:function(n){return new _is.q(this.j,n,this.t,this.m,this.l,this.q,this.p)},b:function(n,t){var i=this.u.a(n,t);this.i.b(i);return i},f:function(n,t){return new _is.bh(n,t?"Hybrid":"Relevance",t)},a:function(n,t,i){return this.v(n,t,this.m,i,null)},e:function(n,t,i,r){return this.v(n,t,null,i,r)},v:function(n,t,i,r,u){this.n.a=r;var f=new _is.S(n,this.n,t,i,u,this.r,this.j,this.o);this.k.b(f);return f},g:function(){if(this.i){for(var i=new _j.q,r=this.i.c(),e=r.length,n=0;n<e;++n){var o=r[n];i.h(o.bh())}return i.i()}else{for(var u=new _j.q,f=this.k.c(),s=f.length,t=0;t<s;++t){var h=f[t];u.h(h.E())}return u.i()}},c:function(n,t){return new _is.G(n,t,this.j,this.l,this.s)}};_is.q=function(n,t,i,r,u,f,e){this.D=Function.createDelegate(this,this.Z);this.K=[];_is.q.initializeBase(this);this.R=r;this.T=t;this.P=i;this.Q=n;this.V=u;this.N=e;this.w=new _is.i(r,"FromRefiner");this.w.apcl("TriggerSearch",this.D);this.y=new _is.i(r,"ToRefiner");this.y.apcl("TriggerSearch",this.D);this.u=new _is.bx(r,this.Q,f);this.u.apcl("TriggerSearch",this.D);this.K.push(this.u);this.x=new _is.i(r,"AttachmentRefiner");this.x.apcl("TriggerSearch",this.D);this.C=new _is.W;this.C.apcl("TriggerSearch",this.D);this.B=new _is.i(r,"HashtagRefiner");this.B.apcl("TriggerSearch",this.D);this.z=new _is.i(r,"ActiontagRefiner");this.z.apcl("TriggerSearch",this.D);if(f){var o=this;f.c(function(n){o.A=n.c();if(o.A){o.A.apcl("TriggerSearch",o.D);o.K.push(o.A);o.A.j(!1)}},!1)}};_is.q.c=function(){var n=new _a.k;n.c(_is.q.a.b);n.c(_is.q.a.a);n.c(_is.q.a.c);return n};_is.q.prototype={P:null,Q:null,R:null,V:null,N:null,A:null,H:null,w:null,y:null,u:null,x:null,v:null,C:null,B:null,z:null,G:null,O:!1,S:!1,L:null,T:null,M:null,J:!1,f:function(){return this.w},i:function(){return this.y},e:function(){return this.u},c:function(){return this.x},d:function(){return this.v},g:function(){return this.A},h:function(){return this.O},U:function(n){if(this.O!==n){this.O=n;this.bw("IsHidden")}return n},j:function(){for(var t=this.K,r=t.length,n=0;n<r;++n){var i=t[n];if(i.b())return i.b().b()}return this.S?_u.R.Bj:this.L.Id===_g.b.a.nameToId("msgfolderroot").Id?_u.R.i:this.G.f(this.L).bD.DisplayName},E:null,r:function(n){this.E=n;return n},W:function(){for(var i=this.K,r=i.length,t=0;t<r;++t){var n=i[t];if(n&&n.b()&&_is.g.isInstanceOfType(n.b()))return n.b().y}return 1},o:function(n,t,i){this.M=i;this.L=t;this.G=n;this.J=this.G.j.a()==="archivemsgfolderroot";this.u.h(this.G.f(this.L));this.v&&!this.v.b()&&this.v.w(_is.q.c())},t:function(){this.U(!1)},s:function(n,t){if(this.W()!==2){var u={};var r=null;t&&(r=t);for(var f="",e="",o="",s="",l=n,it=l.length,h=0;h<it;++h){var i=l[h];_j.e.a(_a.a.t,"PropertyPath: {0} ",i.RefinerCategory,i.RefinerDataEntryTypes.length);switch(i.RefinerCategory){case 4:u[_g.G.toString(4)]="";if(!this.x.b()){var a,v;this.x.w((v=_is.q.b.f(i.RefinerDataEntryTypes,r,a={val:s}),s=a.val,v))}break;case 5:u[_g.G.toString(5)]="";var y,p;var w=(p=_is.q.b.g(this.G,i.RefinerDataEntryTypes,r,y={val:f}),f=y.val,p);w&&this.u.x(w);break;case 3:u[_g.G.toString(3)]="";if(!this.w.b()){var b,k;this.w.w((k=_is.q.b.b(i.RefinerDataEntryTypes,this.P,r,b={val:e}),e=b.val,k))}break;case 2:u[_g.G.toString(2)]="";if(!this.y.b()){var d,g;this.y.w((g=_is.q.b.b(i.RefinerDataEntryTypes,this.P,r,d={val:o}),o=d.val,g))}break;case 6:u[_g.G.toString(6)]="";this.B.b()||this.B.w(_is.q.b.c(i.RefinerDataEntryTypes));break;case 7:u[_g.G.toString(7)]="";this.z.b()||this.z.w(_is.q.b.c(i.RefinerDataEntryTypes));break}}if(r){var rt=f+"0|"+e+"0|"+o+"0|"+s+"0|";this.R.bm(r.c,r.b,rt)}for(var nt=[4,2,3,5,6,7],ut=nt.length,c=0;c<ut;++c){var tt=nt[c];if(!(_g.G.toString(tt)in u))switch(tt){case 5:this.u.b()||this.u.j(this.J);break;case 4:this.x.b()||this.x.j(!1);break;case 3:this.w.b()||this.w.j(!1);break;case 2:this.y.b()||this.y.j(!1);break;case 6:this.B.b()||this.B.j(!1);break;case 7:this.z.b()||this.z.j(!1);break}}this.U(!1)}},n:function(){var t=[];var n=null;if(this.x.b()){n=this.x.b().p;Array.add(t,n)}if(this.u.b()){n=this.u.r();n&&Array.add(t,n)}if(this.w.b()){n=this.w.b().p;Array.add(t,n)}if(this.y.b()){n=this.y.b().p;Array.add(t,n)}if(this.B.b()){n=this.B.b().p;Array.add(t,n)}if(this.z.b()){n=this.z.b().p;Array.add(t,n)}if(t.length){var i=new _g.go;i.RefinerQueries=t;return i}else return null},q:function(){var n=[];var i=null;this.x.b()&&Array.add(n,"A:1");if(this.u.b()){var r=this.u.b().q;Array.add(n,String.format("F:{0}",r))}if(this.w.b()){i=this.w.b().p;Array.add(n,"S")}if(this.y.b()){i=this.y.b().p;Array.add(n,"T")}if(this.A&&this.A.b()){var u=this.A.b().q;Array.add(n,String.format("G:{0}",u))}if(this.v&&this.v.b()){var t=this.v.b();t===_is.q.a.b?Array.add(n,"D:1W"):t===_is.q.a.a?Array.add(n,"D:1M"):t===_is.q.a.c&&Array.add(n,"D:1Y")}return n},b:function(n,t){var u="";var e=null;var o=null;var i=null;var r=null;this.x.b()&&(e=this.x.b().b());this.v&&this.v.b()&&(o=this.v.b().b());if(this.u.b()){i=this.u.b().b();i&&(i=String.format(_u.n.RL,i))}if(this.w.b()){r=this.w.b().b();r&&(r=String.format(_u.n.BO,r))}u=t>-1?String.format(_u.n.Lh,n,t):String.format(_u.n.PY,n);for(var c=[r,i,e,o],s=c,l=s.length,f=0;f<l;++f){var h=s[f];h&&(u+=h+", ")}u+=_u.n.HM;return u},k:function(){if(this.C)return this.C.k();if(this.v&&!this.v.b())return null;var i=this.v.b();var n=_a.d.a();if(i===_is.q.a.b)n=n.c(-7);else if(i===_is.q.a.a)n=n.s(-1);else if(i===_is.q.a.c)n=n.x(-1);else return null;n=n.Q();var t=new _g.dy;t.Item=new _g.d("DateTimeReceived");t.FieldURIOrConstant=new _g.U;var r=new _g.T;r.Value=n.i();t.FieldURIOrConstant.Item=r;return new _g.bd(t)},Z:function(n,t){var r=!0;if(_is.i.isInstanceOfType(n)){var i=n.b();if(_is.f.isInstanceOfType(i))this.X();else if(_xt.a.isInstanceOfType(i)){r=!1;this.Y(n,i)}}r&&this.T(n,t)},m:function(){return this.u.m(this.J)},l:function(){var n=this.u.l();return _j.h.a(this.M)?n:String.format("{0} ({1})",n,this.M)},a:function(n){this.U(!0);this.S=!1;this.J=n;this.H&&this.H.e();this.w&&this.w.j(!1);this.y&&this.y.j(!1);this.x&&this.x.j(!1);this.v&&this.v.j(!1);this.C&&this.C.h();this.u&&this.u.j(this.J);this.A&&this.A.j(!1);this.B&&this.B.j(!1);this.z&&this.z.j(!1)},p:function(n){for(var i=this.K,u=i.length,t=0;t<u;++t){var r=i[t];r&&r.n(n)}},Y:function(n,t){var i=this;var u=function(){i.E(i.H);_is.v.b()};var r=this;var f=function(n){if(n){r.H=n;r.H.f(t,u)}};this.E&&this.N&&this.N.c(f,!1);this.u&&n!==this.u&&this.u.p(null);this.w&&this.w.j(!1);this.y&&this.y.j(!1);this.x&&this.x.j(!1);this.z&&this.z.j(!1);this.B&&this.B.j(!1);this.v&&this.v.j(!1);if(this.C){this.C.h();this.C.i(!0)}},X:function(){this.A&&this.A.p(null);this.E&&this.E(null);this.C&&this.C.i(!1);_is.v.c()}};_is.q.a=function(){};_is.q.b=function(){};_is.q.b.g=function(n,t,i,r){var o=new _j.l;r.val="";if(t.length<=1||!n)return null;for(var s=t,a=s.length,f=0;f<a;++f){var u=s[f];var h=n.f(u.FolderId);if(h){var e=null;var c,l;r.val+=(l=_is.q.b.a(i,u,c={val:e}),e=c.val,l);o.a(new _is.f(u.FolderId,2,h.bD.DisplayName,u.HitCount,u.RefinementQuery,!1,e))}}return o};_is.q.b.f=function(n,t,i){var u=new _a.k;i.val="";if(n.length<=1)return u;for(var o=n,c=o.length,f=0;f<c;++f){var r=o[f];if(r.WithAttachments){var e=null;var s,h;i.val+=(h=_is.q.b.a(t,r,s={val:e}),e=s.val,h);u.c(new _is.m(_nbs.a.sT,r.HitCount,r.RefinementQuery,!1,e))}}return u};_is.q.b.c=function(n){var t=new _a.k;if(n.length<=1)return t;for(var u=n,f=u.length,i=0;i<f;++i){var e=u[i];var r=e;t.c(new _is.m(r.DisplayName,r.HitCount,r.RefinementQuery,!1,null))}return t};_is.q.b.b=function(n,t,i,r){var f=new _a.k;r.val="";if(n.length<=0)return f;for(var s=0,h=n,a=h.length,e=0;e<a;++e){var u=h[e];if(s>=5)break;var v=_is.q.b.d(u.DisplayName,u.SmtpAddress,t);var y=u.SmtpAddress;if(!_j.h.b(y)){var o=null;var c,l;r.val+=(l=_is.q.b.a(i,u,c={val:o}),o=c.val,l);var p=new _is.bg(v,u.HitCount,u.RefinementQuery,o);f.c(p);s++}}return f};_is.q.b.d=function(n,t,i){var u=new _g.f;u.EmailAddress=t;var f=_h.i.a(u,!1);f.bn(1);var r=i.a(f,10,!1,2,!1,!1,!1);r.c(0,n,0);r.c(1,t,0);return r};_is.q.b.a=function(n,t,i){i.val=null;var r="";if(n){r+=n.a[t.RefinementQuery].toString()+"|";i.val=_is.q.b.e(n,t)}return r};_is.q.b.e=function(n,t){return new _is.bb(n.b,n.a[t.RefinementQuery].toString(),n.c)};_is.G=function(n,t,i,r,u){this.i=Function.createDelegate(this,this.m);_is.G.initializeBase(this);this.d=t;this.j=i;var f=this.d.a.indexOf(_db.b.b)>-1;var e=this.d.a.toLocaleUpperCase().startsWith(n.toLocaleUpperCase());if(f||!e)this.l(this.d.a);else{var o=n;var s=this.d.a.substr(n.length);this.l(_j.h.c(_is.G.a,o,s))}this.g=new _j.g(this.i,_a.a.B);this.f=r;u&&(this.h=u.a()!=="Mouse"&&!!r)};_is.G.prototype={d:null,j:null,h:!1,f:null,e:null,g:null,c:function(){return this.d},b:function(){return this.d.a},a:function(){return this.d.a.trim()},l:function(n){if(this.e!==n){this.e=n;this.eH("DisplayString")}return n},m:function(){this.f&&this.f.a(_db.bc,new _db.bc(this.d.a))}};_is.bz=function(n,t){_is.bz.initializeBase(this,[n,t])};_is.bz.prototype={m:null,h:function(n){if(this.m!==n){this.m=n;this.u()}return n},o:function(n){var t=n?this.j.x.length-1:this.j.x.length;if(this.k+1<=t){this.g(this.k+1);return!(!n&&this.k===t)}else return n&&this.k===t},i:function(n){var t=n?0:-1;if(this.k-1>=t){this.g(this.k-1);return!(!n&&this.k===t)}else return n&&this.k===t},e:function(){this.g(-1)},f:function(){var n=this.k;return n>=0&&n<this.j.x.length},d:function(){var n=this.j.x[this.k];n.c.a()},u:function(){this.e();this.j.g();this.r.a()==="Mouse"&&this.m&&this.j.a(new _is.bA(this.m,_nbs.a.Ct))}};_is.bA=function(n,t){_is.bA.initializeBase(this);this.e(n);this.f(t)};_is.bA.prototype={c:null,d:null,a:function(){return this.c},e:function(n){this.c=n;this.bw("ClickCommand");return n},b:function(){return this.d},f:function(n){this.d=n;this.bw("Label");return n}};_is.bg=function(n,t,i,r){_is.bg.initializeBase(this,[n.a().c(),t,i,!1,r]);this.a=n};_is.bg.prototype={a:null};_is.m=function(n,t,i,r,u){_is.m.initializeBase(this);this.q=n;this.Q=t;this.p=i;this.v=r;this.r=u};_is.m.prototype={q:null,r:null,Q:0,p:null,v:!1,u:!1,J:function(n){this.r!==n&&(this.r=n);return n},b:function(){return this.q},m:function(){return this.u},n:function(){this.u=!0},o:function(){this.u=!1}};_is.i=function(n,t){this.s=new _a.k;_is.i.initializeBase(this);this.G=n;this.H=t};_is.i.prototype={G:null,H:null,t:null,u:!1,K:function(){return!this.s||!this.s.b()},o:function(){return this.s},v:function(n){if(this.s!==n){if(this.s)for(var t=0;t<this.s.b();t++)this.s.a(t)&&this.s.a(t).dispose();this.s=n;this.t=null;this.eL("RefinerValues","NoRefinersAvailable")}return n},b:function(){return this.t},p:function(n){if(this.t!==n){this.t&&this.t.o();this.E(this.t,n);this.t=n;this.eH("SelectedRefiner");if(this.t){this.t.n();this.u||this.eH("TriggerSearch")}}return n},N:function(n,t,i){var r=_a.c.b(_a.a.t,"InstantSearchRefinerSelected",!1,null);r.m=this.B(this.H,t,i,n);_a.c.a(r);n.r&&this.G.bn(n.r.c,n.r.b,n.r.a,t)},j:function(n){this.u=!0;this.p(null);this.u=!1;this.v(new _a.k)},w:function(n){this.v(n)},E:function(n,t){},B:function(n,t,i,r){return String.format("RefinerType:{0};Selected:{1};",n,t)}};_is.bh=function(n,t,i){this.n=Function.createDelegate(this,this.s);this.m=Function.createDelegate(this,this.r);_is.bh.initializeBase(this);this.h=n;this.j=i;this.g=t;this.k=this.l()?_u.n.GV:_u.n.IR};_is.bh.prototype={j:!1,f:null,k:null,h:null,g:"DateTime",i:null,b:function(){this.f||this.q();return this.f},c:function(){return this.k},p:function(n){this.k=n;this.bw("SearchResultsSortOptionString");return n},d:function(){return this.h},e:function(){if(!this.i){var n=this,t=this;this.i=new _y.bt(new _y.bx,function(n){return _g.p.isInstanceOfType(n)?n.bD.SortOrderSource:_g.g.isInstanceOfType(n)?n.bD.SortOrderSource:!1},function(n){return n==="DateTime"?_u.n.Bm:_u.n.HO},_u.n.Bm)}return this.i},a:function(){return this.g},q:function(){var n=new _j.g(this.m,_a.a.cy);var t=new _lv.r(_u.n.IR,null,n,this.g==="DateTime",!1,null,"SortOptionsContextMenuView.SortByDualStateContextMenuItem",null);var i=new _j.g(this.n,_a.a.cy);var r=new _lv.r(_u.n.GV,null,i,this.l(),!1,null,"SortOptionsContextMenuView.SortByDualStateContextMenuItem",null);this.f=new _lv.w([t,r])},s:function(){this.o("SortByRelevance");this.f.n(this.f.p.x[1]);if(this.l()){this.f.p.x[1].i(!0);return}this.f.p.x[0].i(!1);this.p(_u.n.GV);this.g=this.j?"Hybrid":"Relevance";this.h(this,null)},r:function(){this.o("SortByDate");this.f.n(this.f.p.x[0]);if(this.g==="DateTime"){this.f.p.x[0].i(!0);return}this.f.p.x[1].i(!1);this.p(_u.n.IR);this.g="DateTime";this.h(this,null)},o:function(n){var t=_a.c.b(_a.a.t,"SearchResultsSortByChanged",!1,null);t.m=n;_a.c.a(t)},l:function(){return this.j?this.g==="Hybrid":this.g==="Relevance"}};_is.bB=function(n,t,i,r,u,f,e,o,s,h){_j.s.a(s,"clientSessionId");this.g=n;this.i=t;this.e=i;this.c=r;this.h=u;this.f=f;this.d=e;this.j=o;this.b=s;this.k=h};_is.bB.prototype={g:null,e:null,c:null,h:null,f:null,d:null,j:null,b:null,k:null,i:null,a:function(n,t){return new _is.H(this.g,this.i,this.e,this.c,n,this.h,this.f,this.d,this.b,this.j,this.k,t)}};_is.H=function(n,t,i,r,u,f,e,o,s,h,c,l){this.Q=Function.createDelegate(this,this.bk);this.R=Function.createDelegate(this,this.bl);this.U=Function.createDelegate(this,this.bm);this.T=Function.createDelegate(this,this.bc);this.S=Function.createDelegate(this,this.bb);this.O=Function.createDelegate(this,this.Z);this.P=Function.createDelegate(this,this.ba);this.A=new _j.q;_is.H.initializeBase(this);_a.b.a(s,"clientSessionId");this.H=s;this.s=_j.h.a(l)?_a.C.a():l;this.z=r;this.M=u;this.r=f;this.t=e;this.J=o;this.K=n;this.D=t;this.w=h;this.B=i;this.N=c!=null?c:150};_is.H.prototype={s:null,z:null,B:null,r:null,t:null,w:null,M:null,J:null,H:null,D:null,v:null,u:null,L:0,y:null,K:null,C:null,N:0,bd:function(n){if(this.u===n)return n;this.u&&this.u.dispose();this.u=n;return n},a:function(){return this.s},d:function(){return this.r?this.r.Q():null},m:function(){return this.u?this.u.l:null},l:function(){return this.v},k:function(){var n=new _is.bo(this.s);n.b(this.P);n.c(this.O);_a.g.a.a(n);this.v=null;this.X()},f:function(n,t,i){this.L=i;var r=this.V(n);r.c(this.S);r.b(this.T);_a.g.a.a(r);this.v=_a.C.a();this.Y(n,t,i);if(this.D){var u=this.D.a(this.v,this.H.a);_a.g.a.a(u)}},n:function(n){if(this.y!==n){this.y=n;_j.m.a().b(this.C);this.C=_j.m.a().a(_is.H.a,"SuperSearch_GetSuggestions",this.U,this.N)}},j:function(n,t,i,r,u,f,e){var s=-1;f==="Hybrid"&&(s=this.L===1?3:5);var o=new _is.p(this.s,n,t,this.W(t),i,r,u,this.z,this.B,f,this.r,e,this.J,this.w,this.v,!0,s,this.d());this.bd(o);this.A.c(o.f);this.v=_a.C.a();return o},bh:function(){return this.A.i()},h:function(){this.r&&this.r.C()},i:function(){this.r&&this.r.D()},q:function(n){var i=n?n.l:null;if(i){var u=i;var r=u.d;if(r.b){var t=r.b;this.r.br(t.c,t.d,t.b);t.a&&this.w.b(t.a,t.b)}}this.r.w(this.s,!!i,!0)},e:function(n){this.w.d(n);this.r.w(this.s,!0,!0)},p:function(n){var t=n.c();this.w.b(n.t(),t.bn())},o:function(n){this.u&&this.u.bm(n)},V:function(n){return new _is.F(this.s,this.bi(n))},Y:function(n,t,i){if(this.r){var r=_h.a.e(n);if(!r)return;var u=r.f(n);var f=_g.j.g(u);this.r.j(this.s,"",t,i,f)}},X:function(){this.u&&this.w.g(this.u.l);this.r&&this.r.i(this.s,"")},Z:function(n){_j.e.b(_a.a.cy,"EndSearchSession call failed.");this.dispose()},ba:function(n){this.dispose()},bb:function(n){_j.e.c(_a.a.cy,"SuperSearchContext::OnWarmupActionFailed with error: "+_is.p.a(n))},bc:function(n){},bm:function(){if(this.y){var n=this.bg(this.y);_a.g.a.a(n);this.y=null;this.C=null}},bg:function(n){var t=this.K.a(this.v,this.s,n);t.b(this.R);t.c(this.Q);return t},W:function(n){if(_h.n.b(n)){var t=new _gg.O;t.FolderScope=new _gg.H;t.FolderScope.BaseFolderId=_g.m.a(n);return[t]}if(_h.n.a(n))if(n.Id===_g.b.a.nameToId("archivemsgfolderroot").Id){var r=new _gg.iu;r.ArchiveTypes=16777215;return[r]}else{var i=new _gg.kp;i.FolderScope=new _gg.H;i.FolderScope.BaseFolderId=_g.m.a(n);return[i]}return null},bi:function(n){var t=this.W(n);if(this.t.a().l().Enabled&&this.t.a().c().Enabled){var i;t.push((i=new _gg.u,i.GroupTypes=4,i))}if(this.t.a().bq().Enabled&&this.t.a().c().Enabled){var r;t.push((r=new _gg.u,r.GroupTypes=8,r))}return t},bl:function(n){var i=_a.c.b(_is.H.a,"SearchSuggestions_Render",!1,null);var t=n;var f=t.f();var e=null;var u="";var o=0;var s=200;if(_is.e.isInstanceOfType(t)){i.q(new _a.B("AutoSuggest"));var r=t;f=r.by();e=r.bk;u=r.l;s=r.N.StatusCode;o=r.o}var h=this;var c=function(n){n||(i.n=_a.c.f);_a.c.a(i);h.w.a(u,o,s,n,i.s.i-i.s.k)};this.bj(f,e,c,t.h(),t.j(),t.e(),u)},bj:function(n,t,i,r,u,f,e){n&&n.length>=0&&this.M(this.bn(n,r,u,f),t,i,u,e)},bk:function(n){_j.e.b(_a.a.cy,n.bf+" failed with error "+_is.p.a(n))},bn:function(n,t,i,r){for(var o=new Array(n.length),s="",u=0;u<n.length;u++){var f=n[u];var h=f.TDSuggestionId.toString();var e=f.substrateSuggestionId;if(!_j.h.a(e)){var c=e.split(_is.w.a);e=c[0];h=c[1]}s+=f.TDSuggestionId+"|";o[u]=new _h.cB(3,f.DisplayText,new _is.bu(r,t.toString(),h,i,e))}this.r.bq(r,t.toString(),i,s);return o}};_is.g=function(n,t,i,r,u,f){_is.g.initializeBase(this,[t,i,r,u,f]);this.w=n};_is.g.prototype={y:0,w:0,T:function(){return this.q}};_is.v=function(){};_is.v.e=function(n,t){var r=_a.p.c("SwitchFromWeSearchToMeSearch");r&&_is.v.a(r);var u=_a.p.b(_a.a.cq,"SwitchFromWeSearchToMeSearch");var f=n?n.j():null;var e=t?t.t():null;var i=new _a.l;i.b("PS",f);i.b("NS",e);u.m=i.toString()};_is.v.c=function(){var n=_a.p.c("SwitchFromWeSearchToMeSearch");n&&_a.p.a(n.e())};_is.v.d=function(n,t){var r=_a.p.c("SwitchFromWeSearchToMeSearch");r&&_is.v.a(r);var o=_a.p.b(_a.a.t,"SwitchFromMeSearchToWeSearch");var s=n?n.t():null;var u=null;var f=null;var e=null;if(t){u=t.j();if(t.a()){f=t.a().d();e=t.a().b()}}var i=new _a.l;i.b("PS",s);i.b("NS",u);i.b("SSId",f);i.b("SQId",e);o.m=i.toString()};_is.v.b=function(){var n=_a.p.c("SwitchFromMeSearchToWeSearch");n&&_a.p.a(n.e())};_is.v.a=function(n){if(n){n.n=_a.c.f;_a.p.a(n.e())}};_is.bP=function(n,t){_is.bP.initializeBase(this,[n,t])};_is.bP.prototype={A:!1,D:function(){return this.A},o:function(){return _is.i.prototype.o.call(this)},v:function(n){var t=_is.i.prototype.o.call(this);_is.i.prototype.v.call(this,n);this.o()!==t&&this.M();return n},n:function(n){if(this.D())for(var t=0;t<this.o().b();t++){var i=this.o().a(t);_xt.a.isInstanceOfType(i)&&i.e(n)}},E:function(n,t){_is.i.prototype.E.call(this,n,t);_xt.a.isInstanceOfType(t)&&(!n||_is.f.isInstanceOfType(n))?_is.v.d(n,t):_is.f.isInstanceOfType(t)&&(!n||_xt.a.isInstanceOfType(n))&&_is.v.e(n,t)},B:function(n,t,i,r){var u="";var f="";i&&_is.g.isInstanceOfType(i)&&(u=i.t());r&&_is.g.isInstanceOfType(r)&&(f=r.t());return String.format("RefinerType:{0};Selected:{1};PreviousScope:{2};NewScope:{3}",n,t,u,f)},M:function(){if(this.o())for(var n=0;n<this.o().b();n++)if(_xt.a.isInstanceOfType(this.o().a(n))){this.A=!0;return}this.A=!1}};_is.X=function(n){_is.X.initializeBase(this);this.__type=_is.X._dataContractName;this.Name=n;this.Attributes=new Array(0)};_is.h=function(n,t){_is.h.initializeBase(this);this.__type=_is.h._dataContractName;this.Key=n;this.Value=t};_is.J=function(){_is.J.initializeBase(this);this.__type=_is.J._dataContractName;this.EventGroups=new Array(0)};_is.K=function(n){_is.K.initializeBase(this);this.__type=_is.K._dataContractName;this.TraceId=n;this.Events=new Array(0)};_is.bk=function(n){_is.bk.initializeBase(this,[n])};_is.C=function(n,t){_is.C.initializeBase(this);this.__type=_is.C._dataContractName;this.ClientId=n;this.ConversationId=t};_is.I=function(){_is.I.initializeBase(this);this.__type=_is.I._dataContractName};_is.y=function(){};_is.y.registerInterface("_is.y");_is.x=function(){};_is.x.registerInterface("_is.x");_is.bK=function(){};_is.bK.registerInterface("_is.bK");_is.Z=function(){};_is.Z.registerInterface("_is.Z");_is.R=function(){};_is.R.registerInterface("_is.R");_is.bL=function(){};_is.bL.registerInterface("_is.bL");_is.T=function(){};_is.T.registerInterface("_is.T");_is.bm=function(n,t){this.a=n||new _j.q;this.b=t||new _j.q};_is.bm.prototype={a:null,b:null};_is.bo=function(n){_is.bo.initializeBase(this);this.e=n};_is.bo.prototype={e:null,K:function(n){var t=new _gg.pZ(200);t.useEmptyPost=!0;var i=new _gg.gE(this.e);var r=new _gg.gD(this.M(),i);n.ez(r,t,this.J,this.H)},cS:function(n,t,i){if(!n||!n.Body){i(Error.create("EndSearchSession call failed."));return}t()}};_is.n=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w){_is.n.initializeBase(this);this.bk=n;this.s=t;this.t=i;this.n=r;this.bg=u;this.bc=f;this.p=e;this.u=s;this.D=o;this.q=h;this.o=c;this.bj=l;this.f=a;this.j=v;this.bi=y;this.k=p;this.r=w};_is.n.b=function(n){switch(n){case 0:case 1:return"MailSearch";case 2:return"PeopleSearch";default:return"Unknown"}};_is.n.prototype={bk:null,s:null,t:null,n:"None",bg:null,bc:!1,q:0,o:0,p:0,u:0,D:0,bj:null,f:0,j:"DateTime",bi:0,r:0,e:null,k:0,h:null,l:function(){return this.W(_is.n.a)},K:function(n){var t=new _gg.lC(this.k);t.useEmptyPost=!0;var i=this.bn();this.h=i;var r=new _gg.dP(this.l(),i);n.eA(r,t,this.J,this.H)},bn:function(){var n=new _gg.gG("Owa",this.bk,this.s,this.t,"EwsId",this.bc,this.p,this.n,this.D,this.u,this.q,this.o,"Owa16");n.SearchScope=this.bj;n.SearchRefiners=this.bg;n.SortOrder=this.j;this.j==="Hybrid"&&(n.MaxHybridCountHint=this.r);n.IncludeDeleted=!0;n.Scenario=_is.n.b(this.bi);return n},cS:function(n,t,i){if(!n||!n.Body||!n.Body.SearchResults){i(Error.create("Search failed."));return}this.e=n.Body.SearchResults;t()}};_is.w=function(){};_is.bq=function(n){this.b=n};_is.bq.prototype={b:null,a:function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p){return new _is.bp(this.b,n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p)}};_is.bp=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w){_is.bp.initializeBase(this,[t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,200,w]);this.bm=n};_is.bp.prototype={bm:null,K:function(n){var i=new _gg.lC(200);var t=this.bn();this.h=t;var r=new _gg.dP(this.l(),t);this.bm.d(r,i,this,this.J,this.H)}};_is.P=function(n,t,i,r,u,f,e,o){this.f=n;this.i=t;this.e=i;this.g=r;this.c=u;this.d=f;this.h=e;this.b=o};_is.P.prototype={i:null,e:null,g:null,c:!1,d:!1,h:null,b:null,f:null,a:function(n,t,i){return new _is.L(this.f,n,t,i,_is.P.a,this.i,this.e,this.g,this.c,this.d,this.h,this.b)}};_is.t=function(n,t,i,r,u,f,e){this.e=t;this.f=i;this.h=n;this.c=r;this.d=u;this.g=f;this.b=e};_is.t.prototype={h:null,e:null,f:null,c:!1,d:!1,g:null,b:null,a:function(n,t,i){return new _is.e(n,t,i,_is.t.a,this.h,this.e,this.f,this.c,this.d,this.g,this.b)}};_is.e=function(n,t,i,r,u,f,e,o,s,h,c){_is.e.initializeBase(this,[t,i,r]);this.bn=u;this.D=n;this.r=o;this.s=s;this.bc=h;this.q=c;this.bm=new Array(0);var l=this;f.a(function(n){l.t=n});var a=this;e.a(function(n){a.u=n})};_is.e.d=function(n){var t="Failed to get suggestions.";n&&(t+=String.format(" Type: {0} Message: {1} StatusCode: {2}",n.ErrorType,n.ErrorMessage,n.StatusCode));var i={};i.ErrorCode=n.StatusCode;return Error.create(t,i)};_is.e.prototype={bn:null,D:null,r:!1,s:!1,bc:null,q:null,bm:null,t:null,u:null,f:function(){return this.bm},by:function(){return _is.bJ.prototype.f.call(this)},bC:function(n){_is.bJ.prototype.bs.call(this,n);return n},bk:null,l:null,bE:function(){return"GetAutoSuggestions"},K:function(n){var i=new _is.bk(200);var t=new _is.C(this.n,this.D);t.QueryString=this.k;t.EnableDebugLogs=this.r;t.EnableHitHighlighting=this.s;t.EntityTypes=this.bB();_j.h.b(this.q)||(t.DebugSettings=this.q);_j.h.b(this.bc)||(t.SubstrateFlights=this.bc);this.bo();n.eR(t,i,this.J,this.H)},cS:function(n,t,i){this.l=this.Q?this.Q.activityId:_is.e.b;if(n&&!n.ErrorType&&n.StatusCode===200){this.bg();var r=this.bv(n.Response);this.bu(r);t()}else i(_is.e.d(n))},V:function(){var n=this.G.ErrorCode;this.bd.n=n.toString();this.bg();var t=this.Q?this.Q.activityId:_is.e.b;this.bn.a(t,this.o,n,!1,-1);_a.dk.prototype.V.call(this)},bv:function(n){if(_j.h.a(n)){_j.e.b(_is.e.a,"AutoSuggest response is empty.");return null}return JsonParser.deserialize(n)},bu:function(n){if(!n){_j.e.b(_is.e.a,"AutoSuggest response couldn't be parsed.");return!1}var r=n.Instrumentation;var i=n.Groups;var t=this.bt(i);this.bC(t.a.i());this.bk=t.b.i();return!0},bB:function(){for(var t=new Array(0),i=this.bi,u=i.length,n=0;n<u;++n){var f=i[n];var r=_is.e.c[f.toString()];_j.h.b(r)||t.push(r)}return t},bt:function(n){n=n||new Array(0);var t=null;var i=null;if(this.t&&this.u)for(var r=0;r<n.length;r++){var u=n[r]||new _is.bl;var f=u.Suggestions||new Array(0);switch(u.Type){case"Keywords":i=new _j.q(this.t.a(f,this.k,this.l));Array.addRange(this.f(),i.i());break;case"People":t=new _j.q(this.u.a(f,this.k,this.l));Array.addRange(this.f(),t.i());break;default:_j.e.a(_is.e.a,"Ignoring {0} search suggestions",u.Type);break}}return new _is.bm(i,t)}};_is.Q=function(){};_is.Q.prototype={a:function(n,t,i){return new _is.E(t,i,_is.Q.a,3,!1)}};_is.bJ=function(n,t,i){_is.bJ.initializeBase(this);this.n=n;this.k=t;this.bi=i};_is.bJ.prototype={n:null,k:null,bi:null,bp:null,bq:0,f:function(){return this.bp},bs:function(n){this.bp=n;return n},e:function(){return this.n},h:function(){return this.bq},j:function(){return this.k},o:0,bo:function(){this.bd=_a.c.b(_a.a.B,this.bE(),!1,null)},bg:function(){var n=this.bd;if(n){var t=this.Q?this.Q.correlationId:"";n.o=t;_a.c.a(n);this.o=n.s.i-n.s.k}}};_is.E=function(n,t,i,r,u){_is.E.initializeBase(this,[n,t,i]);this.p=r;this.l=u};_is.E.a=function(n){var t={};var i="Unknown error in GetSearchSuggestionsAction";if(n&&n.response&&n.response.fault){i+=String.format(" Type: {0} Message: {1} StatusCode: {2}",n.response.fault.ExceptionName,n.response.fault.FaultMessage,n.response.fault.ErrorCode);t.ErrorCode=n.response.fault.ErrorCode}return Error.create(i,t)};_is.E.prototype={p:0,l:!1,bE:function(){return"GetSearchSuggestions"},K:function(n){var i=new _gg.lV(200);i.useEmptyPost=!0;for(var r=0,u=this.bi,f=u.length,t=0;t<f;++t){var e=u[t];r|=e}var o=new _gg.hH(this.n,this.k,r,this.l,this.p);var s=new _gg.hG(this.M(),o);this.bo();n.cr(s,i,this.J,this.H)},cS:function(n,t,i){if(n&&n.Body&&n.Body.ResponseCode==="NoError"&&n.Body.SearchSuggestions){this.bg();var r;var u=[(r=new _g.cn,r.DisplayText=this.k,r.SuggestedQuery=this.k,r.IsDeletable=!1,r.SuggestionKind=1,r.TDSuggestionId=-1,r.Trigger=this.k,r)];var f=n.Body.SearchSuggestions;this.bs(u.concat.apply(u,f.Suggestions));this.bq=f.TDSuggestionsBatchId;t()}else i(_is.E.a(this.Q))},V:function(){this.bd.n=this.O();this.bg();_a.dk.prototype.V.call(this)}};_is.z=function(n,t,i){_is.z.initializeBase(this);this.f=n;this.h=t;this.e=i};_is.z.c=function(n){var t="Failed to log substrate search events.";n&&(t+=String.format(" Type: {0} Message: {1} StatusCode: {2}",n.ErrorType,n.ErrorMessage,n.StatusCode));return t};_is.z.prototype={f:null,h:null,e:null,K:function(n){var i=new _gg.vY(200);var t=new _gg.iB(this.f);t.EventsEnvelope=this.h;t.Events=_is.z.a;_j.h.b(this.e)||(t.SubstrateFlights=this.e);n.gP(t,i,this.J,this.H)},cS:function(n,t,i){if(!n||n.ErrorType){i(Error.create(_is.z.c(n)));return}t()}};_is.F=function(n,t){_is.F.initializeBase(this);this.f=n;this.e=t};_is.F.prototype={f:null,e:null,K:function(n){var i=new _gg.BJ(200);i.useEmptyPost=!0;var t=new _gg.kr(this.f,16777215,1,"EwsId");t.SearchScope=this.e;t.ApplicationId="Owa";var r=new _gg.kq(this.M(),t);n.ix(r,i,this.J,this.H)},cS:function(n,t,i){if(!n||!n.Body){i(Error.create("Start Search Session call failed."));return}t()}};_is.bv=function(n){this.b=n};_is.bv.prototype={b:null,a:function(n,t){return new _is.V(n,t,this.b)}};_is.V=function(n,t,i){_is.V.initializeBase(this);this.f=n;this.h=t;this.e=i};_is.V.b=function(n){var t="Failed to init substrate search.";n&&(t+=String.format(" Type: {0} Message: {1} StatusCode: {2}",n.ErrorType,n.ErrorMessage,n.StatusCode));return t};_is.V.prototype={f:null,h:null,e:null,K:function(n){var i=new _gg.Cb(200);var t=new _gg.kw;t.ConversationId=this.f;t.ClientId=this.h;_j.h.b(this.e)||(t.SubstrateFlights=this.e);n.iF(t,i,this.J,this.H)},cS:function(n,t,i){if(!n||n.ErrorType){i(Error.create(_is.V.b(n)));return}t()}};_is.bH=function(){};_is.bH.prototype={Text:null,QueryText:null,InstUrlSuffix:null,ReferenceId:null,EmailAddresses:null,Id:null,DisplayName:null};_is.bl=function(){};_is.bl.prototype={Suggestions:null,Type:null};_is.bG=function(){};_is.bG.prototype={TraceId:null,InstUrlBase:null};_is.O=function(n){this.a=n};_is.O.prototype={a:null,f:function(n,t){n.append("-------------Start of ExecuteSearch request-------------");n.append(t);this.d(n,t);this.e(n,t);n.append("------------End of ExecuteSearch request-------------");n.append(t)},c:function(){return this.a.Q?this.a.Q.activityId:null},b:function(){var n=this.a.Q;var t=new Sys.StringBuilder;if(n){var i=n.resource;t.append(String.format("CID:{0};CAN:{1};aer:{2};acbt:{3};",n.correlationId,this.a.bf,n.edgeRequest,n.callBackEndTime-n.callBackStartTime));if(i){t.append(String.format("rtfwt:{0};rtrl:{1};rtrsl:{2};rtrsb:{3};",_is.j.b(i),n.requestLength,n.responseLength,n.responseBytes));n.responseEndTimeStamp>0&&t.append(String.format("artcbd:{0};",Math.floor(n.callBackStartTime-n.responseEndTimeStamp)));t.append(_is.j.c(i))}this.a.e?t.append(String.format("RC:{0};",this.a.e.SearchResultsCount)):t.append(String.format("erf: {0}",_is.p.a(this.a)))}var r=t.toString();_j.e.a(_a.a.t,"IS: QueryStatistics Data: "+r);return r},e:function(n,t){var i=this.a.e;if(i){n.append("TDQueryId: "+i.TDQueryId.Id);n.append(t);n.append("MoreResultsAvailable: "+i.MoreResultsAvailable);n.append(t);n.append("ServerDiagnosticsData: "+JsonParser.serialize(i.DiagnosticsData));n.append(t)}n.append("ClientDiagnosticsData: "+this.b());n.append(t)},d:function(n,t){var i=this.a.h;n.append("SessionID: "+i.SearchSessionId);n.append(t);n.append("Query: "+i.Query);n.append(t);n.append("ItemType: "+i.ItemTypes);n.append(t);n.append("ShouldRetrieveRefiners: "+i.RetrieveRefiners);n.append(t);n.append("ResultRowOffset: "+i.ResultRowOffset);n.append(t);n.append("ResultRowCount: "+i.ResultRowCount);n.append(t);n.append("MaxPreviewLength: "+i.MaxPreviewLength);n.append(t);n.append("MaxResultsCountHint: "+i.MaxResultsCountHint);n.append(t)}};_is.bs=function(n,t){this.b=n;this.c=t;this.a={}};_is.bs.prototype={b:null,c:null,a:null};_is.bb=function(n,t,i){this.a=n;this.b=t;this.c=i};_is.bb.prototype={b:null,a:null,c:null};_is.bu=function(n,t,i,r,u){this.c=n;this.d=t;this.b=i;this.e=r;this.a=u};_is.bu.prototype={c:null,d:null,b:null,e:null,a:null};_is.bO=function(){};_is.bO.a=function(){};_is.bO.d=function(n,t,i,r){_is.bO.d.initializeBase(this,[_is.bO.d.a]);this.Attributes=[new _is.h(_is.bO.a.g,n.toString()),new _is.h(_is.bO.a.e,t.toString()),new _is.h(_is.bO.a.h,i?"1":"0")];i&&this.Attributes.push(new _is.h(_is.bO.a.f,r.toString()))};_is.bO.b=function(n,t,i){_is.bO.b.initializeBase(this,[_is.bO.b.a]);this.Attributes=[new _is.h(_is.bO.a.a,t)];_j.h.b(n)||this.Attributes.push(new _is.h(_is.bO.a.c,n));_j.h.b(i)||this.Attributes.push(new _is.h(_is.bO.a.b,i))};_is.bO.e=function(n){_is.bO.e.initializeBase(this,[_is.bO.e.a]);this.Attributes=[new _is.h(_is.bO.a.a,n)]};_is.bO.f=function(n){_is.bO.f.initializeBase(this,[_is.bO.f.a]);this.Attributes=[new _is.h(_is.bO.a.a,n)]};_is.bO.c=function(n){_is.bO.c.initializeBase(this,[_is.bO.c.a]);this.Attributes=[new _is.h(_is.bO.a.d,n)]};_is.bO.g=function(n,t,i){_is.bO.g.initializeBase(this,[n]);this.Attributes=[new _is.h(_is.bO.a.b,t),new _is.h(_is.bO.a.a,i)]};_is.l=function(n,t){this.m=Function.createDelegate(this,this.n);this.k=new _j.q;this.l=n;this.h=t};_is.l.prototype={l:null,h:null,a:function(n,t,i,r,u){if(this.h.e||this.h.b){var f=new _is.bO.d(t,i,r,u);this.j(this.i(n,f))}},b:function(n,t){if(this.h.d&&t!==_is.l.a){var i=new _is.bO.b(t,_a.d.f(_a.d.a()),null);this.j(this.i(n,i))}},d:function(n){if(this.h.d){_j.h.b(n)&&(n="00000000-0000-0000-0000-000000000000");var t=new _is.bO.e(_a.d.f(_a.d.a()));this.j(this.i(n,t))}},e:function(n,t){if(this.h.c){var i=new _is.bO.b(null,_a.d.f(_a.d.a()),t.toString());this.j(this.i(n,i))}},c:function(n,t){if(this.h.b||this.h.c||this.h.a){var i=new _is.bO.c(t);this.j(this.i(n,i))}},f:function(n,t,i,r){if(this.h.a){var u=new _is.bO.g(t,i.toString(),_a.d.f(r));this.j(this.i(n,u))}},g:function(n){if(this.h.b||this.h.c||this.h.a){var t=new _is.bO.f(_a.d.f(_a.d.a()));this.j(this.i(n,t))}},j:function(){for(var t=[],n=0;n<arguments.length;++n)t[n]=arguments[n];!this.k.d.length&&t.length>0&&_j.m.a().a(_is.l.c,"SubstrateSearchLogger",this.m,_is.l.b);this.k.h(t)},n:function(){var t=this.k;this.k=new _j.q;var n;var i=(n=new _is.J,n.EventGroups=t.i(),n);var r=new _is.z("00000000-0000-0000-0000-000000000000",i,this.l);_a.g.a.a(r)},i:function(n){for(var r=[],t=1;t<arguments.length;++t)r[t-1]=arguments[t];var i;return i=new _is.K(n),i.Events=r,i}};_is.l.d=function(n,t,i,r,u){this.e=n;this.d=t;this.b=i;this.c=r;this.a=u};_is.l.d.prototype={e:!1,d:!1,b:!1,c:!1,a:!1};_is.p=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b){this.Y=Function.createDelegate(this,this.bg);this.X=Function.createDelegate(this,this.P);_is.p.initializeBase(this);this.g=n;this.p=t;this.s=i;this.t=r;this.B=this.bp(u);this.y=f;this.z=e;this.x=o;this.L=s;this.q=h;this.o=c;this.S=l;this.k=new _is.p.b;this.O=w;this.bb=a;this.E=b;this.u=v;this.K=y;this.v=this.z?"MailConversations":"MailItems";p&&this.M()};_is.p.a=function(n){if(!n)return"";var i=null;var t=null;if(_is.n.isInstanceOfType(n)){var u=n;if(!u.N||!u.N.Body)return"";i=u.N.Body;t=u.Q}else if(_is.E.isInstanceOfType(n)){var f=n;if(!f.N||!f.N.Body)return"";i=f.N.Body;t=f.Q}else if(_is.F.isInstanceOfType(n)){var e=n;if(!e.N||!e.N.Body)return"";i=e.N.Body;t=e.Q}else if(_is.L.isInstanceOfType(n))return n.p;else if(_is.e.isInstanceOfType(n)){var r=n;if(!r.N||!r.N.ErrorType)return"";t=r.Q;return String.format("ErrorType: {0}; ErrorMessage: {1}; CorrelationId: {2}",r.N.ErrorType,r.N.ErrorMessage,t?t.correlationId:"")}else return"";var o="";t&&(o=t.correlationId);return String.format("StrackTrace: {0}; MessageText: {1}; CorrelationId: {2}",i.StackTrace,i.MessageText,o)};_is.p.prototype={x:null,L:null,k:null,s:null,h:null,j:null,f:null,g:null,p:null,y:null,B:null,t:null,q:"DateTime",o:null,z:!1,E:null,D:null,v:"None",S:0,O:0,w:null,C:null,R:0,i:null,m:null,bb:null,u:null,K:null,l:null,d:function(){return this.j},c:function(n){this.bA("NewServerRefinersAvailable",n)},b:function(n){this.bA("FirstPageSearchSucceeded",n)},a:function(){_j.m.a().j(_a.a.cy,"SuperSearch");this.Q(1);_j.m.a().g()},bm:function(n){this.u.e(this.l,n)},M:function(){if(this.z){this.h=new _is.A(this.s);this.j=new _is.bd(this.h,this.k,this.x)}else{this.h=new _is.bc;this.j=new _is.be(this.h,this.k)}this.f=new _is.bw(this.g);this.f.f("SearchInitiatedTS");this.m=_a.c.b(_a.a.t,"InstantSearchEndToEndTime",!1,null)},Z:function(n){return this.L.a(this.g,this.p,this.y,this.v,this.B,n===1,5,this.bd(n),this.bc(n),250,60,this.t,n,this.q,this.S,this.O)},bc:function(n){return this.n()[n-1][1]},bd:function(n){return this.n()[n-1][0]},U:function(){this.o.b(this.g,this.f.e(),this.i,!0,null,this.h.d(),this.h.e(),null,null,null);var n=this;_j.m.a().c(_a.a.t,"UploadingDiagnosticsData",function(){n.o.b(n.g,n.f.e(),n.i,!0,n.f.g(),null,null,null,null,null)})},N:function(n,t){this.f.h(new _is.O(n));this.o.b(this.g,this.f.e(),this.i,!1,"ExecuteSearchFailed: "+t,null,null,null,null,null);var i=_a.c.b(_a.a.t,"SearchQueryExecute",!1,null);i.m=String.format("ResultCount:{0};ErrorMessage:{1}","-1",t);_a.c.a(i);this.ba(n,t)},bh:function(n){var t=new _xt.j(this.g,this.i,this.p,this.s,this.q,this.E,this.D);var i=this;t.p=function(t){i.u.a(i.l,n.s.i-n.s.k,200,t,_a.d.get_utcNow().e(_a.d.x(n.s.i)))};this.bi(t)},bi:function(n){this.bO("FirstPageSearchSucceeded",n)},n:function(){return _is.p.c},Q:function(n){this.k.j(n);var t=this.Z(n);t.b(this.X);t.c(this.Y);if(n===1){this.f.f("ActionSubmissionTS");this.D=_a.d.get_utcNow()}_a.g.a.a(t)},bg:function(n){if(!this.bK){var t=n;var i=t.f;var r=this.T();this.k.g(i,r);if(i===1)if(r){this.R++;this.Q(i)}else{this.l=t.Q.activityId;var u=this.m;this.j.bP();var f=_is.p.a(t);_j.e.c(_a.a.cy,"ExecuteSearch action failed: "+f);this.N(t,f);this.u.c(this.l,this.K);this.u.a(this.l,u.s.i-u.s.k,t.G.ErrorCode,!1,-1)}}},T:function(){return this.R<=3},P:function(n){if(!this.bK){var r=n;var t=r.e;var i=r.f;if(i===1){this.f.f("ResultsViaResponseTS");this.bn(t.SearchTerms)}this.k.i(i);_j.m.a().g();this.h.i(t);this.j.y(this.h.a.x.length);if(this.be(i,this.A(t,i))){this.j.bQ();this.f.f("ResultsRenderingCompleteTS");var u=this.m;this.ba(r,"");t.TDQueryId&&t.TDQueryId.Id!==r.Q.activityId&&_j.e.c(_a.a.t,"ActivityIdAndTDQueryIdMismatch");this.i=r.Q.activityId;this.l=r.Q.activityId;this.bh(u)}this.f.h(new _is.O(r));if(t.SearchRefiners&&!this.w){this.C=new _is.bs(this.i,this.g);this.w=this.bo(t.SearchRefiners);this.bJ("NewServerRefinersAvailable",this.w,this.C)}this.bf(i);if(this.A(t,i))this.Q(i+1);else{this.k.h(i);this.U()}}},be:function(n,t){return n===1},A:function(n,t){return(n.MoreResultsAvailable||!this.w)&&t<this.n().length},bf:function(n){n===2&&this.j.k(new _h.m(0,50),null,null)},ba:function(n,t){if(this.m){n&&n.Q&&n.Q.correlationId&&(this.m.o=n.Q.correlationId);var i=new _a.l;i.b("Err",t||"");i.b("ITF",this.v);this.m.m=i.toString();_a.c.a(this.m);this.m=null}},bn:function(n){if(!n||!n.length){_j.e.a(_a.a.t,"Search Terms were null or empty");_h.t.a=null;return}for(var r=[],u=n,f=u.length,t=0;t<f;++t){var e=u[t];var i=new _g.cV;i.Scope="SearchAllIndexedProps";i.Value=e;Array.add(r,new _g.cc(i))}_h.t.a=r},bo:function(n){for(var t={},s=n,b=s.length,f=0;f<b;++f){var i=s[f];this.C.a[i.Refiner.RefinerQuery]=i.Refiner.TDRefinerId;switch(i.RefinerType){case 3:var h=i;var k=new _gg.gM(h.Refiner.RefinerQuery,0,h.FolderId);_g.G.toString(5)in t||(t[_g.G.toString(5)]=new _j.q);t[_g.G.toString(5)].c(k);break;case 2:var e=i;var d=new _gg.eE(e.Refiner.RefinerQuery,0,e.DisplayName,e.SmtpAddress);_g.G.toString(3)in t||(t[_g.G.toString(3)]=new _j.q);t[_g.G.toString(3)].c(d);break;case 4:var c=i;var g=new _gg.fN(c.Refiner.RefinerQuery,0,c.HasAttachment);_g.G.toString(4)in t||(t[_g.G.toString(4)]=new _j.q);t[_g.G.toString(4)].c(g);break;case 1:var o=i;var nt=new _gg.eE(o.Refiner.RefinerQuery,0,o.DisplayName,o.SmtpAddress);_g.G.toString(2)in t||(t[_g.G.toString(2)]=new _j.q);t[_g.G.toString(2)].c(nt);break;case 5:break;case 6:break;default:break}}var r=new _j.q;var l=t;for(var a in l){var u={key:a,value:l[a]};switch(u.key){case"FolderEntryId":var v=new _g.db(5);v.RefinerDataEntryTypes=u.value.i();r.c(v);break;case"From":var y=new _g.db(3);y.RefinerDataEntryTypes=u.value.i();r.c(y);break;case"HasAttachment":var p=new _g.db(4);p.RefinerDataEntryTypes=u.value.i();r.c(p);break;case"SearchRecipients":var w=new _g.db(2);w.RefinerDataEntryTypes=u.value.i();r.c(w);break;default:break}}return r.i()},bp:function(n){if(!n)return null;for(var i=new Array(n.RefinerQueries.length),t=0;t<n.RefinerQueries.length;t++){i[t]=new _gg.gz;i[t].RefinerQuery=n.RefinerQueries[t]}return i}};_is.p.b=function(){_is.p.b.initializeBase(this);this.f(1)};_is.p.b.prototype={e:0,b:function(){return this.e===2},a:function(){return this.e===3||this.e===5},d:function(){return!1},c:function(){return this.e===5},f:function(n){if(this.e!==n){this.e=n;this.bW(_is.p.b.a)}return n},i:function(n){if(n===1){this.e===2&&this.f(3);return}this.e===6&&(this.e=7)},j:function(n){if(n===1){(this.e===1||this.e===4)&&this.f(2);return}(this.e===3||this.e===7)&&(this.e=6)},g:function(n,t){if(n===1){this.e===2&&this.f(t?4:5);return}this.e===6&&(this.e=8)},h:function(n){(this.e===7||this.e===3)&&this.f(9)}};_is.bI=function(){};_is.bI.prototype={Groups:null,Instrumentation:null,Logs:null};_is.bw=function(n){this.c={};this.i=n;this.d=new _j.q;this.j=_a.d.a().e(_y.c.a.y())};_is.bw.prototype={i:null,j:0,d:null,a:function(){return this.i},h:function(n){this.d.c(n)},b:function(n,t){n.append("-----------Start of SuperSearchContext----------");n.append(t);for(var r=this.d.d.length,i=0;i<r;i++)this.d.d[i].f(n,t);n.append("----------End of SuperSearchContext------------");n.append(t)},f:function(n){this.c[n]=(new Date).getTime()},g:function(){var n=new Sys.StringBuilder;n.append(String.format("QST:{0};REN:{1};E2E:{2};",this.m(),this.n(),this.l()));var t=this.k();n.append(t.b());n.append(String.format("TFL:{0};",this.j));return n.toString()},e:function(){var n=this.k();return n.c()},m:function(){return this.c.ActionSubmissionTS-this.c.SearchInitiatedTS},n:function(){return this.c.ResultsRenderingCompleteTS-this.c.ResultsViaResponseTS},l:function(){return this.c.ResultsRenderingCompleteTS-this.c.SearchInitiatedTS},k:function(){for(var i=this.d.d.length,n=0;n<i;n++){var t=this.d.d[n];if(t.a.f===1)return t}return null}};_is.bn=function(n,t,i){_is.bn.initializeBase(this);this.h=n;this.e=t;this.f=i};_is.bn.prototype={h:null,e:null,f:null,K:function(n){var t=new _gg.pX(0);if(this.e){t.remoteUserIdentifier=this.e;t.explicitLogonUser=this.e;t.selfIdentifier=this.f}n.ey(this.h,t,this.J,this.H)},cS:function(n,t,i){n&&t()}};_is.j=function(){};_is.j.c=function(n){var t=new Sys.StringBuilder;if(n){_is.j.a(t,"xhr",n.startTime,n.responseEnd);_is.j.a(t,"rt",n.redirectStart,n.redirectEnd);_is.j.a(t,"ft",n.fetchStart,n.responseEnd);_is.j.a(t,"dn",n.domainLookupStart,n.domainLookupEnd);_is.j.a(t,"ct",n.connectStart,n.connectEnd);n.secureConnectionStart>0&&_is.j.a(t,"st",n.secureConnectionStart,n.connectEnd);_is.j.a(t,"rq",n.requestStart,n.responseStart);_is.j.a(t,"rs",n.responseStart,n.responseEnd)}return t.toString()};_is.j.b=function(n){return n&&n.fetchStart>=0&&n.startTime>=0?Math.floor(n.fetchStart-n.startTime):0};_is.j.a=function(n,t,i,r){n.append(String.format("art{0}:{1};",t,Math.floor(r-i).toString()))};_is.N=function(n,t,i,r){_is.N.initializeBase(this,[t,i]);_j.s.b(n,"calendar");this.G=n;this.K=r;this.H=_a.c.b(_is.N.a,"SearchEventsOnCalendar",!1,null)};_is.N.prototype={G:null,H:null,K:null,L:0,J:0,e:function(){return this.H},g:function(){return this.K},h:function(){return this.L},f:function(){return this.J},i:function(n,t){this.L=t;this.J=n===-1?0:(new Date).getTime()-n},Y:function(){this.t="CalendarSearchResultsTime";this.B="CalendarSearchCallCompleteTime";this.E="CalendarSearchRenderingTime";this.C="CalendarSearchEndToEndTime"}};_is.br=function(n,t,i,r,u,f,e){this.U=Function.createDelegate(this,this.be);this.T=Function.createDelegate(this,this.bd);_is.br.initializeBase(this);if(!n)throw Error.argumentNull("action","Action cannot be null");this.k=new _is.c(n.e());this.A=i;this.o=t;this.N=r;this.w=f;this.O=e;this.Y();_a.O.a(_a.a.t,this.t,3);var o;this.n=_a.c.b(_a.a.t,this.C,!1,(o=new _a.L,o.c=!0,o));this.q=_a.c.b(_a.a.t,this.B,!1,null);this.j=n;this.p=new _is.br.a;this.bc();this.V=u;this.v=new _is.br.b;this.y=!!this.w&&!!this.w.a().d()&&this.w.a().d().Enabled;this.k.e("SearchInitiatedTS");this.S=_a.d.a().e(_y.c.a.y())};_is.br.prototype={p:null,N:null,s:null,j:null,l:null,D:!1,k:null,w:null,O:null,y:!1,S:0,n:null,r:null,m:null,q:null,o:null,z:null,A:null,C:null,t:null,R:null,B:null,E:null,P:!1,v:null,u:null,Y:function(){this.t="InstantSearchResultsTime";this.R="InstantSearchRefinerTime";this.B="InstantSearchCallCompleteTime";this.E="InstantSearchRenderingTime";this.C="InstantSearchEndToEndTime"},a:function(){return this.s},b:function(){return this.p},Q:function(){return this.j.Q?this.j.Q.activityId:null},d:function(){return this.j},c:function(){this.j.c(this.T);this.j.b(this.U);this.k.e("ActionSubmissionTS");_a.g.a.a(this.j);this.M++;this.o&&this.o.bp(this.j.e().SearchSessionId,this.j.e().SearchRequestId,this.j.e().KqlQuery);this.p.j();_j.m.a().j(_a.a.t,"InstantSearch");_j.e.a(_a.a.t,"Started new task runner context before starting search.");this.r=_a.c.b(_a.a.t,this.t,!1,null);(this.j.e().QueryOptions&4)==4&&(this.m=_a.c.b(_a.a.t,this.R,!1,null));_j.m.a().g()},bb:function(){return this.j.e().SearchRequestId},V:!1,M:0,bh:function(n){if((n.ResultType&4)==4||(n.ResultType&2)==2){this.k.e("ResultsViaNotificationTS");this.Z(n);this.k.g.ResultsViaNotification=n.PerfMarkers}if((n.ResultType&8)==8){this.k.e("RefinersNotificationTS");this.bi(n);this.k.g.RefinersViaNotification=n.PerfMarkers}if((n.ResultType&16)==16){this.k.e("SearchTermsNotificationTS");this.ba(n);this.k.g.SearchTermsViaNotification=n.PerfMarkers}n.QueryProcessingComplete&&this.bk(n)},bf:function(){this.W("InstantSearchFailure_UserCancelled","UserInitiatedSessionEnd")},bx:function(){if(!this.D){this.l.dispose();this.D=!0;_j.R.prototype.bx.call(this)}},Z:function(n){if(this.P)this.bj(n);else{this.bg(n);this.P=!0}},bg:function(n){var i=null;this.j.Q&&(i=this.j.Q.correlationId);var r=_a.c.b(_a.a.t,this.E,!1,null);_j.m.a().g();this.l.f(n);this.s.y(this.l.a.x.length);this.bO("ResultsAvailable",this.l.a.x.length);this.p.i();this.s.bQ();r.o=i;_a.c.a(r);this.k.h=this.l.a.x.length;this.k.e("ResultsRenderingCompleteTS");if(this.n){this.n.o=i;this.n.m=this.x("");_a.c.a(this.n);this.n=null}_a.O.b(this.t);this.u=new _is.br.b;this.o&&this.o.b(this.j.e().SearchSessionId,this.Q(),this.j.e().SearchRequestId.toString(),!0,null,this.l.d(),this.l.e(),null,null,null);if(this.o&&this.k.f){var t=this;_j.m.a().c(_a.a.t,"ProcessIncomingSearchResults",function(){t.o.b(t.j.e().SearchSessionId,t.Q(),t.j.e().SearchRequestId.toString(),!0,t.X(t.k.f),null,null,null,null,null)})}this.y&&this.O.a(_a.W,new _a.W(21))},bj:function(n){this.l.f(n);this.s.y(this.l.a.x.length)},bi:function(n){_a.c.a(this.m);this.m=null;if(this.D)throw Error.invalidOperation("InstantSearchContext already disposed");if(!(this.p.e===7)){this.p.h();this.z=n.RefinerData;this.z&&this.z.length>0&&this.bO("NewServerRefinersAvailable",this.z)}var r="";if(n.RefinerData)for(var u=n.RefinerData,o=u.length,t=0;t<o;++t){var i=u[t];var f=i.RefinerCategory;var e=i.RefinerDataEntryTypes?i.RefinerDataEntryTypes.length:0;this.k.u(f,e);r+=_g.G.toString(f)+":"+e+";"}this.o&&this.o.bo(this.j.e().SearchSessionId,this.j.e().SearchRequestId,r);return},ba:function(n){if(this.p.e!==7){if(!n.SearchTerms||!n.SearchTerms.length){_h.t.a=null;return}for(var r=[],u=n.SearchTerms,f=u.length,t=0;t<f;++t){var e=u[t];var i=new _g.cV;i.Scope="SearchAllIndexedProps";i.Value=e;Array.add(r,new _g.cc(i))}_h.t.a=r}},bk:function(n){var i=null;n.Errors&&n.Errors.length>0&&(i=n.Errors[0]);if(this.m){this.m.n=i;_a.c.a(this.m);this.m=null}if(this.q){this.q.n=i;_a.c.a(this.q);this.q=null}if(this.o&&this.p.a()){var t=this;_j.m.a().c(_a.a.t,"QueryProcessingComplete",function(){t.o.b(t.j.e().SearchSessionId,t.j.Q?t.j.Q.activityId:null,t.j.e().SearchRequestId.toString(),!i,t.X(n.QueryStatistics),null,null,null,null,null)})}},be:function(n){var i=this.j.N;var t=i.Payload;if((t.ResultType&2)!=2&&(t.ResultType&4)!=4&&(t.ResultType&128)!=128&&(t.ResultType&16)!=16&&t.ResultType&0){_j.e.c(_a.a.t,"Received Success Callback with null results");return}if(!this.bK){this.k.e("ResultsViaResponseTS");if(this.r){this.r.o=n.Q.correlationId;_a.c.a(this.r);this.r=null}(t.ResultType&16)==16&&this.ba(t);this.p.a()?_j.e.a(_a.a.t,"Ignoring response since a notification with data has already arrived"):this.Z(t);this.k.g["Results-Via Response"]=t.PerfMarkers}},bd:function(n){this.p.g();var i="InstantSearchFailure_UnknownError";var t="";if(_g.V.a(n.G)){i=_g.V.b(n.G)||"InstantSearchFailure_UnknownError";t=n.G.FaultMessage}else t=_is.S.a(n);_j.e.b(_a.a.t,"PerformInstantSearch action failed: "+t);this.s.bP();this.W(i,t);this.o&&this.o.b(this.j.e().SearchSessionId,this.Q(),this.j.e().SearchRequestId.toString(),!1,"InvocationFailure",null,null,null,null,null);var r=_a.c.b(_a.a.t,"SearchQueryExecute",!1,null);r.m=String.format("ResultCount:{0}","-1");_a.c.a(r)},x:function(n){var t=new _a.l;t.b("Err",n||"");t.b("IT",this.j.e().ItemType.toString());return t.toString()},W:function(n,t){var i=null;var r=null;if(this.j){r=this.j.O();this.j.Q&&(i=this.j.Q.correlationId)}if(this.r){this.r.o=i;this.r.n=r;this.r.p=n;this.r.m=this.x(t);_a.c.a(this.r);this.r=null;_a.O.b(this.t)}if(this.m){this.m.n=r;this.m.p=n;this.m.o=i;this.m.m=this.x(t);_a.c.a(this.m);this.m=null}if(this.q){this.q.n=r;this.q.p=n;this.q.o=i;this.q.m=this.x(t);_a.c.a(this.q);this.q=null}if(this.n){this.n.n=r;this.n.p=n;this.n.o=i;this.n.m=this.x(t);_a.c.a(this.n);this.n=null}},bc:function(){switch(this.j.e().ItemType){case 2:this.l=new _is.A(this.j.e().FolderScope[0]);this.s=new _is.bd(this.l,this.p,this.N);break;case 3:this.l=new _is.o;this.s=new _is.bt(this.l,this.p);break;case 1:this.l=new _is.bc;this.s=new _is.be(this.l,this.p);break;default:throw Error.argumentOutOfRange("itemShape");}},X:function(n){var t=new Sys.StringBuilder;t.append(String.format("Ver:{0};",1));var i=this.j.Q;var u;if(i){t.append(String.format("CID:{0};CAN:{1};aer:{2};acbt:{3};",i.correlationId,this.j.h,i.edgeRequest,i.callBackEndTime-i.callBackStartTime));u=i.resource;if(u){t.append(String.format("rtfwt:{0};rtrl:{1};rtrsl:{2};rtrsb:{3};",_is.j.b(u),i.requestLength,i.responseLength,i.responseBytes));i.responseEndTimeStamp>0&&t.append(String.format("artcbd:{0};",Math.floor(i.callBackStartTime-i.responseEndTimeStamp)));t.append(_is.j.c(u))}}if(this.A&&this.A.length>0){t.append("RFNR:");for(var h=this.A,y=h.length,f=0;f<y;++f){var p=h[f];t.append(String.format("{0},",p))}}t.append(String.format("RC:{0};FPRC:{1};QST:{2};REN:{3};OPT:{4};DR:{5};EDR:{6};E2E:{7};",this.l.a.x.length,this.k.h,this.k.k(),this.k.l(),this.k.r(),this.k.p(),this.k.z(),this.k.o()));this.u&&this.v&&t.append(String.format("HSLBS:{0};MUBS:{1};TMBS:{2};HSLAS:{3};MUAS:{4};TMAS:{5};",this.v.a,this.v.c,this.v.b,this.u.a,this.u.c,this.u.b));this.y&&t.append(String.format("EFAds:{0};",this.y));_g.k.a&&_g.k.a.n&&t.append(String.format("CMM:{0};CMS:{1};PD:{2};",_g.k.a.n.d?1:0,_g.k.a.n.a?1:0,_g.k.a.n.j));t.append(String.format("TFL:{0};",this.S));if(n){t.append(String.format("V:{0};",n.Version));t.append(String.format("SS:{0};",n.StoreByPassed?"1":"0"));if(n.Steps){var e=null;t.append("STPS:");for(var c=n.Steps,w=c.length,o=0;o<w;++o){var r=c[o];t.append(String.format("{0}={1},",r.StepType,r.StepTime));if(r.StepType==="GetRefiners"&&r.AdditionalEntries)for(var l=r.AdditionalEntries,b=l.length,s=0;s<b;++s){var a=l[s];a.indexOf("CorrelationId")>=0&&(e=a.replace("CorrelationId=>","RCID:"))}}t.append(";");e&&t.append(String.format("{0};",e))}}var v=t.toString();_j.e.a(_a.a.t,"IS: QueryStatistics Data: "+v);return v}};_is.br.a=function(){_is.br.a.initializeBase(this);this.f(1)};_is.br.a.prototype={e:0,b:function(){return this.e===2||this.e===4},a:function(){return this.e===3||this.e===7||this.e===5},d:function(){return!1},c:function(){return this.e===7},f:function(n){if(this.e!==n){this.e=n;this.bW(_is.br.a.a)}return n},j:function(){this.f(2)},i:function(){this.e===2?this.f(3):this.e===4&&this.f(5)},h:function(){this.e===2?this.f(4):this.e===3&&this.f(5)},g:function(){this.f(7)}};_is.br.b=function(){this.a=-1;this.b=-1;this.c=-1;try{var n=window.performance?window.performance.memory:null;if(n){this.a=n.jsHeapSizeLimit;this.b=n.totalJSHeapSize;this.c=n.usedJSHeapSize}}catch(t){}};_is.br.b.prototype={a:0,b:0,c:0};_is.c=function(n){this.c={};this.g={};this.j=new _j.q;this.n={};this.d=n};_is.c.a=function(n,t){for(var i=0;i<t*3;i++)n.append("&nbsp;")};_is.c.prototype={f:null,d:null,h:0,i:null,m:!1,a:function(){return this.d.SearchSessionId},v:function(){return this.j.i()},e:function(n){this.c[n]=(new Date).getTime()},t:function(n){this.j.h(n)},u:function(n,t){this.n[_g.G.toString(n)]=t},k:function(){return this.c.ActionSubmissionTS-this.c.SearchInitiatedTS},p:function(){return this.c.ResultsViaResponseTS-this.c.ActionSubmissionTS},y:function(){return this.c.ResultsViaNotificationTS-this.c.ActionSubmissionTS},x:function(){return this.c.RefinersNotificationTS-this.c.ActionSubmissionTS},w:function(){return this.c.SearchTermsNotificationTS-this.c.ActionSubmissionTS},l:function(){return this.c.ResultsRenderingCompleteTS-this.q()},r:function(){return this.k()+this.l()},o:function(){return this.c.ResultsRenderingCompleteTS-this.c.SearchInitiatedTS},q:function(){var n=this.c.ResultsViaResponseTS;var t=this.c.ResultsViaNotificationTS;return isNaN(n)?t:isNaN(t)?n:Math.min(n,t)},z:function(){return this.q()-this.c.ActionSubmissionTS},b:function(n,t){n.append("--------------------------------------------");n.append(t);this.D(n,t);this.B(n,t,2);this.s(n,this.g,t,2);this.C(n,t,2);this.E(n,t,2);this.A(n,t,2);n.append("--------------------------------------------");n.append(t)},D:function(n,t){n.append("--------------------------------------------");n.append(t);n.append("SessionID: "+this.d.SearchSessionId);n.append(t);n.append("SearchRequestID: "+this.d.SearchRequestId);n.append(t);n.append("Query: "+this.d.KqlQuery);n.append(t);n.append("Query Options: "+this.d.QueryOptions+": ");this.d.QueryOptions&1&&n.append("Suggestions; ");this.d.QueryOptions&2&&n.append("Results; ");this.d.QueryOptions&4&&n.append("Refiners; ");this.d.QueryOptions&16&&n.append("ExplicitSearch; ");this.d.QueryOptions&8&&n.append("SearchTerms; ");n.append(t);n.append("ItemType: "+this.d.ItemType);n.append(t);n.append("First Page ResultCount: "+this.h);n.append(t);n.append("PipeLineReload: "+this.m);n.append(t);n.append("RefinerCounts: ");n.append(t);this.F(n,this.n,t,2)},B:function(n,t,i){n.append("Client Perf Data");n.append(t);var r=this.c.SearchInitiatedTS;if(this.d.QueryOptions&1){var u=this.c.SearchSuggestionsNotificationTS;_is.c.a(n,i);n.append("Time to SearchSuggestion Retrieval: "+(u-r)+"mS");n.append(t)}else{_is.c.a(n,i);n.append("Time to Query Submission: "+this.k()+"mS");n.append(t);_is.c.a(n,i);n.append("From QuerySubmission to SearchResults Via Response: "+this.p()+"mS");n.append(t);_is.c.a(n,i);n.append("From QuerySubmission to SearchResults Via Notification: "+this.y()+"mS");n.append(t);_is.c.a(n,i);n.append("From QuerySubmission to SearchTerms: "+this.w()+"mS");n.append(t);_is.c.a(n,i);n.append("From QuerySubmission to Refiners: "+this.x()+"mS");n.append(t);_is.c.a(n,i);n.append("Rendering time: "+this.l()+"mS");n.append(t);_is.c.a(n,i);n.append("Time in Owa: "+this.r()+"mS");n.append(t);_is.c.a(n,i);n.append("End To End Time: "+this.o()+"mS");n.append(t)}n.append(t)},C:function(n,t,i){var r=this.v();if(r&&r.length>0){_is.c.a(n,i);n.append("Errors:");n.append(t);for(var f=r,e=f.length,u=0;u<e;++u){var o=f[u];_is.c.a(n,i+1);n.append(o);n.append(t)}}},s:function(n,t,i,r){r++;n.append("Server Perf Data");n.append(i);var e=t;for(var o in e){var s={key:o,value:e[o]};var h=s.key;var u=s.value;if(u&&u.length>0){_is.c.a(n,r);n.append(h);n.append(i);for(var f=0;f<u.length;f++){var c=String.format("{0} => {1} mS",u[f].PerfKey,u[f].PerfValueMS);_is.c.a(n,r+1);n.append(c);n.append(i)}n.append(i)}}},A:function(n,t,i){if(this.i)n.appendLine("Server Breadcrumbs");else{n.appendLine("No breadcrumb information found");return}for(var u={},f=this.i,o=f.length,r=0;r<o;++r){var e=f[r];var s=e.QueryOptions;var h=e.PerfMarkers;u[s.toString()]=h}this.s(n,u,t,i)},E:function(n,t,i){if(this.f){var h=String.format("QueryStats -> Version: {0}, Start: {1}, Time In Query: {2} mS, StoreByPassed: {3}",this.f.Version,this.f.StartTime,this.f.QueryTime,this.f.StoreByPassed);n.append(h);n.append(t);for(var o=this.f.Steps,c=o.length,u=0;u<c;++u){var r=o[u];var f=String.format("QueryStats Step -> StepType: {0}, Time in Step: {1} mS StartTime: {2}",r.StepType,r.StepTime,r.StartTime);_is.c.a(n,i);n.append(f);n.append(t);for(var s=r.AdditionalEntries,l=s.length,e=0;e<l;++e){var a=s[e];f=String.format("AdditionalInfo : {0}",a);_is.c.a(n,i+1);n.append(f);n.append(t)}}n.append(t)}},F:function(n,t,i,r){if(t){var u=t;for(var f in u){var e={key:f,value:u[f]};_is.c.a(n,r+1);n.append(String.format("{0} => {1}",e.key,e.value));n.append(i)}}}};_is.S=function(n,t,i,r,u,f,e,o){this.p=Function.createDelegate(this,this.J);this.q=Function.createDelegate(this,this.K);this.u=Function.createDelegate(this,this.G);this.v=Function.createDelegate(this,this.L);this.w=Function.createDelegate(this,this.M);this.y=Function.createDelegate(this,this.O);this.x=Function.createDelegate(this,this.N);this.t=new _is.S.b;this.i={};_is.S.initializeBase(this);this.f=_a.C.a();this.s=_a.d.get_utcNow();this.A=!1;this.h=u;this.r=o;this.j=r;this.j&&this.j.j(this.f,this.z(!1),1,1,"");this.k=f;this.m=n;_j.e.a(_a.a.t,"Instantiating InstantSearchSession. ItemType {0}, Mailbox:{1}, LoggedInUser:{2}",n,u||"empty",f||"empty");if(!i)throw Error.argumentNull("folderScope");this.o=i;this.l=t;this.R()};_is.S.a=function(n){return n?n.G?_j.h.a(n.G.message)?Object.getType(n.G).toString():n.G.message:"Action.Error null":"Action null"};_is.S.prototype={l:null,f:null,g:null,m:0,h:null,k:null,s:null,r:null,n:!1,e:null,o:null,j:null,A:!1,c:function(){return this.n},C:function(n){if(this.n!==n){this.n=n;this.H();this.bw("IsReady")}return n},B:function(n){if(this.e===n)return n;this.e&&this.e.dispose();this.e=n;return n},d:function(n,t){var u=[t.e()];var i=_is.b.j(this.f,u,n,this.h,this.k);this.l.f(n);var r=new _is.N(t,i,this.j,n);this.B(r);this.i[i.e().SearchRequestId.toString()]=this.e.k;return r},a:function(n,t,i,r,u,f,e,o){if(!t)throw Error.argumentNull("folderScope");if(_j.e.f){_j.e.a(_a.a.t,"PerformSearch QS: {0}",n);if(i&&i.RefinerQueries&&i.RefinerQueries.length>0)for(var h=i.RefinerQueries,l=h.length,s=0;s<l;++s){var a=h[s];_j.e.a(_a.a.t,"Refiner: {0}",a)}_j.e.a(_a.a.t,"FolderId: {0}",t.Id);_j.e.a(_a.a.t,"DateRestriction: {0}",r)}var v=this;_j.m.a().c(_a.a.t,"InstantSearchSession",function(){v.l.f(n)});var c=_is.b.k(this.f,t,n,this.m,i,r,this.h,this.k,f?250:25);this.B(new _is.br(c,this.j,u,this.r,f,e,o));this.i[c.e().SearchRequestId.toString()]=this.e.k;return this.e},D:function(){_j.e.a(_a.a.t,"CreateServerSession. SessionId: {0}",this.f);var n=_is.b.m(this.f,this.o,this.m,this.h,this.k);var t=new _is.c(n.e());this.i[n.e().SearchRequestId.toString()]=t;n.c(this.x);n.b(this.y);t.e("SearchInitiatedTS");_a.g.a.a(n)},Q:function(){_j.e.a(_a.a.t,"InstantSearchSession::PrefetchSearchSuggestions()");var n=_is.b.l(this.f,this.o,"",this.m,this.h,this.k,!0,!0);var t=new _is.c(n.e());this.i[n.e().SearchRequestId.toString()]=t;n.c(this.w);n.b(this.v);t.e("SearchInitiatedTS");_a.g.a.a(n)},b:function(){var n=new _is.bn(this.f,this.h,this.k);n.b(this.u);_a.g.a.a(n);this.g.v(this.q);_h.bR.isInstanceOfType(this.g)&&this.g.O(this.p);this.g=null;this.e&&this.e.bf();if(this.j){var t=this.z(!0);this.j.i(this.f,t)}},E:function(){var n=new _j.q;var t=this.i;for(var i in t){var r={key:i,value:t[i]};n.c(r.value)}return n.i()},M:function(n){_j.e.b(_a.a.t,"GetSearchSuggestion action failed: "+_is.S.a(n))},L:function(n){var i=n;var t=i.N;(i.e().QueryOptions&32)==32&&(this.l.c=!0);t.Payload&&t.Payload.SearchSuggestions&&this.l.e(t.Payload.SearchSuggestions,0)},O:function(n){this.l.c||this.Q()},N:function(n){},G:function(n){var r=n;if(r){var t=r.N.RequestIds;var u=r.N.SearchPathSnapshots;if(!u||!t){_j.e.b(_a.a.t,"No diagnostic data from EndSearchSession retrieved");return}for(var e=t.length,i=0;i<t.length;i++){var f=this.i[t[i].toString()];f?f.i=u[i]:_j.e.b(_a.a.t,"No requestID found")}}this.dispose()},R:function(){var n=new _g.R;n.NotificationType="InstantSearchNotification";n.ChannelId=_no.a.a;if(this.h){this.g=new _h.bR(n,null,null,this.h,this.k);this.g.J(this.p)}else this.g=new _h.I(n);this.g.m(_a.a.B,"InstantSearchNotificationStrategy",this.q,0);this.g.o&&this.C(!0)},z:function(n){var t=new Sys.StringBuilder;t.append(String.format("SearchedItemType={0};SearchCount={1}",this.m,this.e?this.e.M:0));if(n){var i=_a.d.get_utcNow().e(this.s);t.append(String.format(";SessionDuration={0}",i))}return t.toString()},J:function(n,t){this.C(!0)},H:function(){this.n&&this.D()},K:function(n){if(n.EventType==="Reload"){this.e&&(this.e.k.m=!0);return}var i=n;var t=i.InstantSearchPayload;if(!t){_j.e.b(_a.a.t,"Received null payload for sessionID {0}",this.f);return}if(t.SearchSessionId!==this.f){_j.e.b(_a.a.t,"Received stale notification for sessionID {0}",t.SearchSessionId);return}if(this.t.c(t.SearchRequestId)&&t.ResultType&1){var r=this.t.b(t.SearchRequestId);this.l.i(r,t.SearchSuggestions);var u=this.i[t.SearchRequestId.toString()];u.e("SearchSuggestionsNotificationTS")}this.e&&this.e.bb()===t.SearchRequestId&&this.e.bh(t);this.P(t)},P:function(n){var t=this.i[n.SearchRequestId.toString()];n.ResultType&64&&(t.f=n.QueryStatistics);if((n.ResultType&32)==32){t.t(n.Errors);t.g.Errors=n.PerfMarkers;for(var r=n.Errors,u=r.length,i=0;i<u;++i){var f=r[i];_j.e.c(_a.a.t,"Error Notification received from server {0}.",f)}}}};_is.S.b=function(){this.d={};this.a={}};_is.S.b.prototype={b:function(n){return this.a[n.toString()]},c:function(n){return n.toString()in this.a}};_is.bM=function(){_is.bM.initializeBase(this);this.a=this.o()};_is.bM.prototype={a:null,i:function(n){},p:function(){return this.a.d()},b:function(n){return this.a.p(n,!0)},d:function(){return new Array(0)},e:function(){return new Array(0)},t:function(n,t){if(t<0||n+t>this.a.x.length)throw Error.argumentOutOfRange("resultCount");if(!t)return new Array(0);for(var r=new Array(t),i=0;i<t;i++)r[i]=this.a.x[i+n];return r},o:function(){return new _j.l},h:function(n){for(var i=this.a.x.length,r=new Array(i),t=0;t<i;t++){var u=this.a.x[t];u&&(r[t]=n(u))}return r},bx:function(){this.g();_j.R.prototype.bx.call(this)}};_is.o=function(){_is.o.initializeBase(this)};_is.o.a=function(n){return n.Q()?n.fk()?n.fk().a():_dg.x.a:n.a()};_is.o.b=function(n,t){var i=n;var r=t;if(i.Q()!==r.Q())return i.Q()?-1:1;var u=_is.o.a(i);var f=_is.o.a(r);if(u.B(f)){u=i.a();f=r.a()}return _is.o.c(u,f)};_is.o.c=function(n,t){return t.b(n)};_is.o.prototype={f:function(n){this.a.g();for(var i=n.CalendarItems,r=i.length,t=0;t<r;++t){var u=i[t];var f=this.c(u);this.a.a(f)}},j:function(n){if(!this.a.x.length)return 0;var t=this;return _ff.s.a(function(n){return t.a.x[n]},n,_is.o.b,0,this.a.x.length-1)},o:function(){return new _a.dd(_is.o.b)},c:function(n){return new _dg.a(n)},g:function(){this.a.g()}};_is.A=function(n){this.l=Function.createDelegate(this,this.w);this.k=Function.createDelegate(this,this.v);this.j=Function.createDelegate(this,this.u);this.c={};this.n={};_is.A.initializeBase(this);_a.b.a(n,"conversationFolderId");this.m=n};_is.A.prototype={m:null,i:function(n){if(n&&n.Conversations)for(var i=n.Conversations,r=i.length,t=0;t<r;++t){var u=i[t];this.q(u)}},f:function(n){if(n.Conversations&&n.Conversations.length)for(var i=this.a.x.length,t=i;t<n.Conversations.length;t++){var r=n.Conversations[t];this.q(r)}},g:function(){for(var n=0;n<this.a.x.length;n++)this.b(this.a.x[n]);this.c={}},b:function(n){var t=n;t.dC(this.j);t.dG(this.k);this.x(t);delete this.c[t.bD.ConversationId.Id];return _is.bM.prototype.b.call(this,n)},d:function(){var t=this;var n=function(n){return n&&n.a()&&n.a().b()>0?n.a().a(0).Id:"-1"};return this.h(n)},e:function(){var t=this;var n=function(n){return n.bD.SortOrderSource};return this.h(n)},q:function(n){var t=new _g.p;t.l(n);t.M(this.m);t.bn(this.a.x.length.toString());t.y(2);t.bg(n.MessageCount||2);t.dE(this.j);t.dF(this.k);this.a.a(t);this.c[t.bD.ConversationId.Id]=t},u:function(n,t){var i=n;i&&this.b(i)},v:function(n,t){for(var f=n,r=t,u=0;u<this.a.x.length;u++){var i=this.a.x[u];if(i.bD.ConversationId.Id===f.bD.ConversationId.Id&&i.bD.InstanceKey!==f.bD.InstanceKey)switch(r.a){case"UnreadCount":i.n(r.b);break;case"GlobalUnreadCount":i.N(r.b);break;case"FlagStatus":i.Z(r.b);break;case"IsPinned":i.bf(r.b);break;case"GlobalItemIds":i.ba(r.b);break;case"DraftItemIds":var e=r.b;i.e()&&i.e()!==e&&i.e().kz("Count");i.bl(e);break;default:break}}},w:function(n,t){var r=n;this.r(r.bD.ItemId.Id,this.l);if(r.bD.ConversationId){for(var i=this.c[r.bD.ConversationId.Id],s=t,u=0;u<i.a().b();u++){var o=i.a().a(u).Id;if(r.bD.ItemId.Id===o){_lm.a.a(r)&&!r.a()&&i.bD.UnreadCount>0&&i.n(i.bD.UnreadCount-1);i.a().o(u);break}}for(var f=0;f<i.c().b();f++)if(i.c().a(f).Id===r.bD.ItemId.Id){i.c().o(f);if(i.e())for(var e=0;e<i.e().b();e++)i.e().a(e).Id===r.bD.ItemId.Id&&i.e().o(e);break}i.a().b()||this.b(i)}},x:function(n){var t=n.a();if(t&&t.b())for(var i=0;i<t.b();i++)this.r(t.a(i).Id,this.l)},r:function(n,t){if(n in this.n){_h.d.a().f.a(n,2,t);delete this.n[n]}}};_is.bc=function(){this.c=Function.createDelegate(this,this.k);_is.bc.initializeBase(this)};_is.bc.prototype={i:function(n){if(n&&n.Items)for(var i=n.Items,u=i.length,t=0;t<u;++t){var f=i[t];var r=this.j(f);_h.d.a().f.b(r.bD.ItemId.Id,2,this.c);this.a.a(r)}},f:function(n){if(n.Items&&n.Items.length)for(var i=this.a.x.length,t=i;t<n.Items.length;t++){var r=n.Items[t];var u=this.j(r);this.a.a(u)}},d:function(){var t=this;var n=function(n){return n&&n.bD.ItemId?n.bD.ItemId.Id:"-1"};return this.h(n)},e:function(){var t=this;var n=function(n){return n.bD.SortOrderSource};return this.h(n)},g:function(){for(var n=0;n<this.a.x.length;n++)this.b(this.a.x[n])},b:function(n){var t=n;_h.d.a().f.a(t.bD.ItemId.Id,2,this.c);return this.l(t)},l:function(n){for(var i=!1,t=this.a.x.length-1;t>=0;t--){var r=this.a.x[t];if(r.bD.ItemId.Id===n.bD.ItemId.Id){this.a.n(t);_h.d.a().c(r.bD.ItemId.Id);i=!0}}return i},k:function(n,t){var i=n;i&&this.b(i)},j:function(n){var i=n.ItemId.Id;var t=_h.d.a().a(i);if(!t){t=_g.g.a(n);t.dR(this.a.x.length.toString());_h.d.a().b(i,t);return t}var r=_g.g.a(n);r.jh(n.SortOrderSource);r.dR(this.a.x.length.toString());_h.d.a().e(i);return r}};_is.B=function(){this.b={};this.b={}};_is.B.c=function(n,t){if(!n||!n.length)return t;if(!t||!t.length)return n;for(var i={},f=n,a=f.length,r=0;r<a;++r){var e=f[r];i[e.SuggestedQuery]=e}for(var o=t,v=o.length,u=0;u<v;++u){var s=o[u];i[s.SuggestedQuery]=s}var h=[];var c=i;for(var l in c){var y={key:l,value:c[l]};Array.add(h,y.value)}return h};_is.B.a=function(n,t,i){if(_j.e.f&&i&&!(i.length<=0))for(var e=[],f=i,o=f.length,r=0;r<o;++r){var u=f[r];Array.add(e,String.format("{0}:{1}:{2}",u.SuggestedQuery,u.Weight,u.SuggestionSource))}};_is.B.b=function(n,t){var i=n;var r=t;return i.Weight===r.Weight?0:i.Weight>r.Weight?-1:1};_is.B.prototype={a:null,c:!1,i:function(n,t){_is.B.a("New SearchSuggestions Received From Server: ",n,t);if(t&&t.length>0){this.d(n,t);this.a&&this.a(n,this.h(n))}},f:function(n){n=n.trim();for(var r=Math.min(n.length,25),i=0;i<r;i++){var u=n.substr(0,i+1);var t=new _gg.jA;t.SuggestedQuery=n;t.SuggestionSource=1;t.Weight=1;this.d(u,[t])}},e:function(n,t){var i=Math.min(t+25,n.length);if(t===i){this.a&&this.a(null,null);return}for(var r=t;r<i;r++)this.g(n[r]);var u=this;_j.m.a().c(_a.a.t,"AddSearchSuggestions",function(){u.e(n,i)})},g:function(n){if(n.SuggestedQuery){n.SuggestedQuery=n.SuggestedQuery.substring(0,25).trim();for(var i=n.SuggestedQuery,r=i.length,t=0;t<r;t++){var u=i.substr(0,t+1);this.d(u,[n])}}},h:function(n){n||(n="");var t=this.b[n.toUpperCase()];if(!t||!t.length)return null;t.sort(_is.B.b);_is.B.a(String.format("Returning {0} results from cache",t.length),n,t);for(var i=[],f=t,e=f.length,r=0;r<e;++r){var u=f[r];u.SuggestionSource&1?Array.add(i,new _h.cB(3,u.SuggestedQuery,null)):Array.add(i,new _h.cB(4,u.SuggestedQuery,null))}return i},d:function(n,t){n||(n="");var i=this.b[n.toUpperCase()];var r=_is.B.c(i,t);this.b[n.toUpperCase()]=r}};_is.U=function(n,t){_is.U.initializeBase(this);this.bs=n;this.br=new(_ff.w.$$(_fm.r));this.y(0);this.bX=t;this.bB=new _is.U.a(this.bH())};_is.U.prototype={bs:null,cg:!1,br:null,bC:0,bR:!1,bY:0,bt:0,bM:!1,bF:!1,ch:0,bX:null,bB:null,bu:null,bc:function(n){this.apcl("Loading",n)},bn:function(n){this.rpcl("Loading",n)},e:function(){return this.bB.b()},a:function(){return this.br},c:function(){return this.bB},r:function(){return null},j:function(){return this.bX},g:function(){return _is.U.b},d:function(){return this.cg},h:function(){return this.bt},cn:function(n){if(this.bt!==n){this.bt=n;this.bw("LoadedStartIndex")}return n},bf:function(){return!1},n:function(){return this.ch},i:function(){return this.bM},cj:function(n){if(this.bM!==n){this.bM=n;this.bw("Merging")}return n},u:function(){return null},w:function(){return null},x:function(){return!1},ce:function(){return this.bt+this.br.x.length-1},o:function(){return this.bK},bh:function(){return!0},b:function(){return this.bC},y:function(n){if(this.bC!==n){this.bC=n;this.bw("TableSize")}return n},bg:function(){return this.bY},J:function(){return!1},K:function(){return this.bR},H:function(){return!1},m:function(){this.bu||(this.bu=new _j.l);if(this.bu.x.length!==this.bs.a.x.length){this.bu.g();this.bu.j(this.bs.p())}return this.bu},z:function(){this.bF=!1},N:function(){this.bF=!0},bl:function(){},bk:function(){},bq:function(n){return!1},bi:function(n){return n},bQ:function(){},bP:function(){},v:function(){return this.bF},k:function(n,t,i){this.cj(!0);var e=this.bV(n);var r=e.a<=0?0:e.a;var u=e.d()>=this.bs.a.x.length?this.bs.a.x.length-1:e.d();var f=this.ce();if(this.bs.a.x.length)if(this.br.x.length){if(r!==this.bt||u!==f)if(u<this.bt){this.bS();this.br.H(this.bE(r,u),2)}else if(r>f){this.bS();this.br.H(this.bE(r,u),2)}else{if(r<this.bt){var h=this.bE(r,this.bt-1);this.br.O(0,h,3)}else if(r>this.bt){var c=r-this.bt;this.ci(0,c)}if(u<f){var o=f-u;var l=this.br.x.length-o;this.ci(l,o)}else if(u>f){var a=this.bE(f+1,u);this.br.H(a,2)}}}else{var s=this.bE(r,u);this.br.H(s,1)}else this.bS();this.cn(r);this.y(this.bs.a.x.length);this.cj(!1)},p:function(n,t){this.k(n,null,null)},bm:function(){this.k(new _h.m(this.bt,this.ce()),null,null)},bp:function(){this.y(0)},bd:function(n){this.bA("Stale",n)},bo:function(n){this.bD("Stale",n)},L:function(n,t){},be:function(n){return!1},bj:function(){},cf:function(n,t,i){var r=this.bT(n.Id);t.val=null;i.val=null;if(r>=this.br.x.length){_j.e.a(_a.a.t,"GetAdjacentItems: current item not found in the table");return}r-1>=0&&(t.val=this.br.x[r-1]);r+1<this.br.x.length&&(i.val=this.br.x[r+1])},cm:function(n){return this.bT(n.Id)<this.br.x.length},bV:function(n){if(_h.m.isInstanceOfType(n)){this.bR=!1;return n}throw Error.invalidOperation("loadRowsArg");},bT:function(n){var t=this;return this.br.k(function(i){return t.bL(i)===n})},bS:function(){for(var t=this.br.x.length,n=0;n<t;n++)this.bG(this.br.x[n]);this.br.g()},bE:function(n,t){for(var f=t-n+1,r=this.bs.t(n,f),u=r,e=u.length,i=0;i<e;++i){var o=u[i];this.bN(o)}return r},ci:function(n,t){for(var f=n,r=n+t-1,i=n;i<=r;i++){var u=this.br.x[i];this.bG(u)}this.br.r(n,t)}};_is.U.a=function(n){_a.b.a(n,"prefixForKey");this.c=_is.U.b;this.d=n+"_"+_is.U.a.a;_is.U.a.a++};_is.U.a.prototype={c:null,d:null,b:function(){return this.c},a:function(){return this.d}};_is.bt=function(n,t){_is.bt.initializeBase(this,[n,t])};_is.bt.prototype={bH:function(){return"SearchResultsCalendar"},bV:function(n){if(_h.bI.isInstanceOfType(n)){var t=n;if(_dg.bv.isInstanceOfType(t.a)){var r=_a.d.b(t.a.a);var i=this.bs.j(r);this.bY=i;this.bR=!0;i+=t.b;return new _h.m(i,t.c)}throw Error.invalidOperation("loadRowsArg.Condition");}return _is.U.prototype.bV.call(this,n)},bN:function(n){},bG:function(n){},bL:function(n){return null}};_is.bd=function(n,t,i){this.ca=Function.createDelegate(this,this.cp);this.bZ=Function.createDelegate(this,this.co);_is.bd.initializeBase(this,[n,t]);if(!_is.A.isInstanceOfType(n))throw Error.argumentType("resultsCache",Object.getType(n),_is.A);var r=this;this.by=new _h.dE(201,function(n){return!0},i)};_is.bd.prototype={by:null,bH:function(){return"SearchResultsConversations"},O:function(n){},l:function(n){return this.bs.c[n]},P:function(n,t){if(this.bF&&this.cm(n)){this.by.B(n,t);this.cq(n)}},Q:function(n){},N:function(){_is.U.prototype.N.call(this);this.by.N()},z:function(){_is.U.prototype.z.call(this);this.by.z()},bx:function(){this.by.dispose();_j.R.prototype.bx.call(this)},bN:function(n){var t=n;t.dE(this.bZ);this.cr(t)},bG:function(n){var t=n;t.dC(this.bZ);this.cs(t)},bL:function(n){return n?n.bD.ConversationId.Id:null},co:function(n,t){var i=n;i&&this.br.A(i,4)},cr:function(n){var i=n.a();if(n.a()&&n.a().b())for(var t=0;t<i.b();t++)_h.d.a().f.b(i.a(t).Id,1,this.ca)},cs:function(n){var t=n.a();if(t&&t.b())for(var i=0;i<t.b();i++)_h.d.a().f.a(t.a(i).Id,1,this.ca)},cp:function(n,t){var u=t;var f=u.a;var i=n;if(f==="IsRead"){var r=this.l(i.bD.ConversationId.Id);if(!r)return;this.ct(i,r)}},ct:function(n,t){n.a()?t.bD.UnreadCount>0&&t.n(t.bD.UnreadCount-1):t.n(t.bD.UnreadCount+1)},cq:function(n){var t,i;var r,u;this.cf(n,r={val:t},u={val:i});t=r.val;i=u.val;this.ck(i);this.ck(t)},ck:function(n){if(n){var t=_h.d.a().a(n.bD.ConversationId.Id);(!t||t.n(n))&&this.by.f(n,!0)}}};_is.be=function(n,t){this.Q=Function.createDelegate(this,this.ca);this.by=Function.createDelegate(this,this.bZ);_is.be.initializeBase(this,[n,t]);this.P=new _h.dk(201,this.by,null)};_is.be.prototype={P:null,bH:function(){return"SearchResultsMail"},O:function(n){var t,i;var r,u;this.cf(n,r={val:t},u={val:i});t=r.val;i=u.val;this.bv(i);this.bv(t)},N:function(){_is.U.prototype.N.call(this);this.P.N()},l:function(n,t){this.bv(this.M(n.Id))},M:function(n){var t=this.bT(n);return t>=this.br.x.length?null:this.br.x[t]},bN:function(n){var t=n;_h.d.a().f.b(t.bD.ItemId.Id,2,this.Q)},bG:function(n){var t=n;_h.d.a().f.a(t.bD.ItemId.Id,2,this.Q)},bL:function(n){return n?n.bD.ItemId.Id:null},ca:function(n,t){var r=n;if(r)for(var i=this.br.x.length-1;i>=0;i--){var u=this.br.x[i];if(u.bD.ItemId.Id===r.bD.ItemId.Id){this.br.y(i,4);_h.d.a().f.a(u.bD.ItemId.Id,2,this.Q)}}},bZ:function(n){return n.bQ()===1||n.bQ()===5},bv:function(n){n&&!this.P.m(n)&&this.bZ(n)&&(!n.cd()||n.dd)&&this.P.f(n)}};_is.bN=function(n,t){_is.bN.initializeBase(this,[n,t])};_is.bN.prototype={cl:!1,cc:!1,q:function(){return this.cc},ba:function(n){this.cc=n;return n},cb:!1,C:function(){return this.cb},Z:function(n){this.cb=n;return n},B:function(){return-1},G:function(n){this.cl=n;return n},A:function(n){},t:function(n){},bQ:function(){_is.U.prototype.bQ.call(this);var n=_a.d.get_utcNow();this.k(new _h.m(0,25),null,null);_j.e.a(_a.a.t,"PERF :: LoadRows: {0}",_a.d.get_utcNow().e(n));n=_a.d.get_utcNow();this.bw("SearchStateChanged");_j.e.a(_a.a.t,"PERF :: FireSearchStateChanged Update: {0} ",_a.d.get_utcNow().e(n))},bP:function(){_is.U.prototype.bP.call(this);this.bw("SearchStateChanged")},f:function(n){return new Array(0)},V:function(n){return new Array(0)},bb:function(n,t){},S:function(n,t){},Y:function(n,t){},D:function(n){return null},R:function(n,t){},E:function(n){},U:function(n){return null},s:function(){return this.e()},W:function(n){},X:function(n){},T:function(){return null}};_is.b=function(n,t,i,r,u){this.n=-1;_is.b.initializeBase(this);if(!n)throw Error.argumentNull("request","Request cannot be null");if(!r)throw Error.argumentNull("actionName","ActionName cannot be null");this.f=t;this.k=i;this.j=n;this.h=r;this.l=u};_is.b.j=function(n,t,i,r,u){if(!n)throw Error.argumentNull("sessionId");if(!t||!t.length)throw Error.argumentNull("folderIds");var f=new _gg.bU(n,3,2,_is.b.a(),i);f.MaximumResultCount=250;f.FolderScope=t;f.WaitOnSearchResults=!0;f.ApplicationId="Owa;CalendarSearch";return new _is.b(f,r,u,_is.b.d,!1)};_is.b.k=function(n,t,i,r,u,f,e,o,s){if(_j.h.a(n))throw Error.argumentNull("sessionId");if(!t)throw Error.argumentNull("folderScope");if(r!==2&&r!==1)throw Error.argument("itemShape","This method is valid only for email searches");t=new _g.l(t.Id);var c=10;c=c|4;c=c|16;var h=new _gg.bU(n,r,c,_is.b.a(),i);h.ApplicationId="Owa;MailSearch";h.MaximumResultCount=s;h.FolderScope=[t];h.IsDeepTraversal=t.Id===_g.b.a.nameToId("msgfolderroot").Id;u&&(h.RefinementFilter=u);f&&(h.AdditionalRestrictions=f);h.WaitOnSearchResults=!0;h.OptimizeFirstPageLoad=!0;var l=r===1?_is.b.h:_is.b.g;return new _is.b(h,e,o,l,!0)};_is.b.m=function(n,t,i,r,u){if(_j.h.a(n))throw Error.argumentNull("sessionId");if(!t)throw Error.argumentNull("folderScope");t=new _g.l(t.Id);var f=new _gg.bU(n,i,2,_is.b.a(),"");f.ApplicationId="Owa;WarmUp";t.Id===_g.b.a.nameToId("inbox").Id&&(t=_g.b.a.nameToId("msgfolderroot"));f.IsDeepTraversal=t.Id===_g.b.a.nameToId("msgfolderroot").Id;f.FolderScope=[t];return new _is.b(f,r,u,_is.b.i,!0)};_is.b.l=function(n,t,i,r,u,f,e,o){if(_j.h.a(n))throw Error.argumentNull("sessionId");if(!t)throw Error.argumentNull("folderScope");t=new _g.l(t.Id);var s=new _gg.bU(n,r,e?32:1,_is.b.a(),i);s.ApplicationId="Owa;GetSearchSuggestions";s.FolderScope=[t];s.WaitOnSearchResults=o;if(e){s.SuggestionSources=1;s.MaxSuggestionsCount=1e3}else{s.SuggestionSources=16;s.MaxSuggestionsCount=10}return new _is.b(s,u,f,e?_is.b.f:_is.b.e,!0)};_is.b.a=function(){var n=_is.b.b;return parseInt((_is.b.b=(new Date).getTime()).toString()+(_is.b.c=n===_is.b.b?++_is.b.c%10:0).toString(),10)};_is.b.prototype={j:null,f:null,k:null,h:null,l:!1,e:function(){return this.j},K:function(n){var t=new _gg.xy(0);t.actionName=this.h;if(this.f){t.remoteUserIdentifier=this.f;t.explicitLogonUser=this.f;t.selfIdentifier=this.k}t.useEmptyPost=this.l;this.n=(new Date).getTime();n.hh(this.j,t,this.J,this.H)},cS:function(n,t,i){n&&n.Payload?t():i(null)}};_is.ba=function(){};_is.ba.prototype={a:function(n,t,i,r,u){},b:function(n,t){},d:function(n){},e:function(n,t){},c:function(n,t){},f:function(n,t,i,r){},g:function(n){}};_is.k=function(n){this.g=_j.D.a();_is.k.initializeBase(this,[n]);this.O(_j.D.a());this.y("SearchRefinerCategoryView")};_is.k.prototype={c:null,d:null,b:!1,f:function(){return this.cl()},a:function(n){this.d=n;this.bw("RefinerValueTemplateId");return n},e:function(){return this.c+" "+_u.n.ED},h:function(n){this.c=n;this.bw("RefinerCategoryName");return n}};_is.r=function(n,t){this.c=Function.createDelegate(this,this.d);_is.r.initializeBase(this,[n,t]);this.b=new _j.g(this.c,_a.a.t)};_is.r.prototype={b:null,a:!1,dQ:function(n){var t=this.cm(n.fb());var i=null;_is.i.isInstanceOfType(this.V())&&(i=this.V().b());this.cT(this.x(),t)?this.a||this.be(null):this.be(t);!_is.i.isInstanceOfType(this.V())||!_is.m.isInstanceOfType(t);this.V().N(t,!!this.x(),i);this.bw("UserActionTaken")},ds:function(n){var t=_fce.a.prototype.ds.call(this,n);var i=this.gZ(n);_is.m.isInstanceOfType(i)&&i.v&&t.l(!0);return t},d:function(){this.bQ()===this.x()?this.be(null):this.be(this.bQ())}};_is.bC=function(n){_is.bC.initializeBase(this,[n])};_is.bC.prototype={Y:function(){if(this.V()){!_is.g.isInstanceOfType(this.V());_is.f.isInstanceOfType(this.V())?this.y("ScopeRefinerView.FolderScopeRefinerView"):_xt.a.isInstanceOfType(this.V())&&this.y("GroupsScopeRefinerView")}_j.i.prototype.Y.call(this)}};_is.bF=function(){};_is.bF.registerInterface("_is.bF");_is.Y=function(){};_is.Y.registerInterface("_is.Y");function InstantSearchComponent(){}InstantSearchComponent.$$cctor=function(){_a.t.a().a(InstantSearchComponent)};InstantSearchComponent.prototype={b:function(n,t,i){var o=this;n.b(_is.s,function(){var t=n.a(_a.cQ);return new _is.s(t.a(),n.a(_a.cw))}).a();var s=this;n.b(_is.M,function(){var t=n.a(_a.cQ);return new _is.M(t.a(),n.a(_a.cw))}).a();var h=this;n.b(_y.cz,function(){var t=n.a(_a.f);var i=!!t&&t.a().l().Enabled&&t.a().c().Enabled;return new _is.by(n.a(_is.bf),n.a(_h.o),n.a(_g.E).bD.LogonEmailAddress,n.a(_a.f),n.a(_bc.f),n.a(IConversationItemPartsFactory),n.a(_j.j),n.a(_y.a),i?n.d(_xt.f):null,i?n.d(_xt.e):null)}).a();var c=this;n.b(_y.fa,function(){return new _is.bz(n.a(_y.a),new _y.C(n.a(_y.a),n.a(_g.h),n.d(_bc.z),n.a(_a.f)))});var l=this;n.b(_is.u,function(){return new _is.u}).a();var a=this;n.b(_is.bf,function(){var r=i.b().a.searchtypedowntimeout;var t=_j.h.b(r)?null:parseInt(r);_j.s.c(!(t!=null)||!isNaN(t),"searchtypedown URL Parameter must be a number");return new _is.bB(n.a(_is.R),n.a(_is.T),n.a(_is.Z),n.a(IConversationItemPartsFactory),n.a(_h.o),n.a(_a.f),n.a(_j.j),n.a(_db.S),n.a(_is.D),t)});var r=this;n.b(_db.S,function(){var t=n.a(_a.f);if(t&&(t.a().G().Enabled||t.a().fY().Enabled)){var i=new _is.l.d(t.a().km().Enabled,t.a().kl().Enabled,t.a().kj().Enabled,t.a().kk().Enabled,t.a().ki().Enabled);return new _is.l(r.c(t),i)}else return new _is.ba}).a();var v=this;n.b(_is.D,function(){return new _is.D}).a();var u=this;n.b(_is.R,function(){var r;var t=n.a(_a.f);var h=!!t&&t.a().G().Enabled&&_g.a.a().c().bD.IsSubstrateSearchServiceAvailable;var c=!!t&&t.a().fR().Enabled;var f=!1;var e=!0;var o=u.c(t);var s=i.b().b("searchtesthook")?i.b().a.searchtesthook:"";r=c?new _is.P(n.a(_is.s),n.a(_db.S),n.d(_is.x),n.d(_is.y),f,e,o,s):h?new _is.t(n.a(_db.S),n.d(_is.x),n.d(_is.y),f,e,o,s):new _is.Q;return r});var y=this;n.b(_is.Z,function(){var t;var i=n.a(_a.f);var r=!!i&&i.a().fY().Enabled&&_g.a.a().c().bD.IsSubstrateSearchServiceAvailable;t=r?new _is.bq(n.a(_is.M)):new _is.u;return t});var f=this;n.b(_is.t,function(){var t=n.a(_a.f);var s=!!t&&t.a().G().Enabled&&_g.a.a().c().bD.IsSubstrateSearchServiceAvailable;var h=!!t&&t.a().fR().Enabled;var r=!1;var u=!0;var e=f.c(t);var o=i.b().b("searchtesthook")?i.b().a.searchtesthook:"";return new _is.t(n.a(_db.S),n.d(_is.x),n.d(_is.y),r,u,e,o)});var e=this;n.b(_is.T,function(){var t=n.a(_a.f);var i=null;t&&t.a().G().Enabled&&(i=new _is.bv(e.c(t)));return i})},a:function(){return null},c:function(n){var t=[];n.a().ko().Enabled&&t.push("SuperAutoSuggestions_5CharGAL");n.a().G().Enabled&&!t.length&&t.push("SuperAutoSuggestions");n.a().ka().Enabled&&t.push("SearchSuggestionsV2");return t.join(",")}};_is.D=function(){this.a=_a.C.a()};_is.D.prototype={a:null};_is.d=function(){};_is.d.c=function(){return _fm.b.a(_fm.a.V,_fm.WebfontSizes.a.g,"ms-fcl-ns-b")};_is.d.e=function(){return _fm.b.a(_fm.a.V,_fm.WebfontSizes.a.g,"ms-fcl-np-b")};_is.d.a=function(){return _fm.b.a(_fm.a.d,_fm.WebfontSizes.a.a,"ms-fcl-ns-b")};_is.d.b=function(){return _fm.b.b(_fm.a.m,null,[_fm.WebfontSizes.a.d,"ms-fcl-ns-b"],null,null,null,null,["ms-icon-flip-glyph"])};_is.d.d=function(){return _fm.b.b(_fm.a.n,_fm.a.l,null,null,null,null,null,null)};_is.L=function(n,t,i,r,u,f,e,o,s,h,c,l){_is.L.initializeBase(this,[t,i,r,u,f,e,o,s,h,c,l]);this.bj=n};_is.L.prototype={bj:null,p:null,K:function(n){var i=new _gg.lV(200);var t;var r=(t=new _is.C(this.D,this.n),t.QueryString=this.k,t.EnableDebugLogs=this.r,t.EnableHitHighlighting=this.s,t);this.bo();this.bj.c(r,i,this,this.J,this.H)}};_is.s=function(n,t){this.b=n+_is.s.a;this.a=t};_is.s.prototype={a:null,b:null,c:function(n,t,i,r,u){var f=new XMLHttpRequest;var e=new _g.H(new _g.cM(_is.s.a,n,t));var s=this;f.onreadystatechange=function(){if(f.readyState===4)if(f.status===200){var n;var s=(n=new _is.I,n.Response=f.responseText,n.StatusCode=f.status,n);e.activityId=f.getResponseHeader("request-id");if(!e.activityId&&f.responseText){var o=JsonParser.deserialize(f.responseText);e.activityId=o.Instrumentation?o.Instrumentation.TraceId:""}e.responseBytes=parseInt(f.getResponseHeader("Content-lenght")||"0");r(e,s)}else{i.p=String.format("ErrorType: {0}; ErrorMessage: {1}; CorrelationId: {2}",f.status,f.responseText,t.correlationId);u(Error.create(i.p))}};var o=this.b+"?query="+n.QueryString+"&cvid="+n.ConversationId;n.EnableDebugLogs&&(o+="&debug=1");n.EnableHitHighlighting&&(o+="&textdecorations=1");f.open("GET",o,!0);f.setRequestHeader("client-request-id",t.correlationId);f.setRequestHeader("client-session-id",n.ClientId);f.setRequestHeader(_a.w.c(),_a.w.d());f.setRequestHeader(this.a.a(),this.a.a());f.send(null)}};_is.M=function(n,t){this.b=n+"/beta/substratesearch/query";this.a=t};_is.M.prototype={a:null,b:null,d:function(n,t,i,r,u){var f=new _g.H(new _g.cM("ExecuteSearch",n,t));var e=this.c(n,t,f);e.set_body(JsonParser.serialize(n,!0));var o=this;e.add_completed(function(n){var t=n.getResponseHeader("Content-Length");f.activityId=n.getResponseHeader("request-id");f.responseBytes=parseInt(t);f.webrequestCompletedCount++;f.webrequestCompletedCount>1;o.e(f,n,r,u)});e.invoke()},c:function(n,t,i){var r=new Sys.Net.WebRequest;r.set_httpVerb("POST");r.get_headers()["client-request-id"]=t.correlationId;r.get_headers()["client-session-id"]=n.Body.SearchSessionId;r.get_headers().Action=i.request.methodName;r.get_headers()["Content-Type"]="application/json; charset=utf-8";r.get_headers()[_a.w.c()]=_a.w.d();r.get_headers()[this.a.a()]=this.a.b();r.set_timeout(6e4);r.set_url(this.b);return r},e:function(n,t,i,r){if(t.get_responseAvailable()){var u=t.get_responseData();i(n,JsonParser.deserialize(u))}else r(Error.create("Failed"))}};_is.bi=function(){};_is.bi.registerInterface("_is.bi");_is.bQ=function(){};_is.bQ.registerInterface("_is.bQ");_is.bj=function(){};_is.bj.registerInterface("_is.bj");_is.a=function(){};_is.a.$$cctor=function(){_is.a._I()};_is.a.bH=function(){var n=window.document.createElement("DIV");n.innerHTML="<div> <div class='_is_5'><label class='_is_4'></label></div> <div class='_is_5'><label class='_is_4'></label></div> <div class='_is_5'><label class='_is_4'></label></div> <div class='_is_5'><label class='_is_4'></label></div> <div class='_is_5'><label class='_is_4'></label></div> <span class='_is_7 ms-font-weight-semibold ms-font-color-neutralDark'></span> <div class='_is_2'></div> <span class='_is_7 _is_8 ms-font-weight-semibold ms-font-color-neutralDark'></span> <div class='_is_2'></div> </div><div> <div> <span class='_is_3 ms-font-weight-semibold ms-font-color-neutralDark'></span> <div class='_is_6'></div> </div> </div><div> <span class='_is_a'></span> <span class='_is_b ms-font-weight-regular'></span> </div><div>  <button type='button' class='_is_9'></button>  <button type='button' class='_is_9'></button> </div><div> <form action=\"javascript:void(0);\"> <div class='_is_i _is_e _is_k'> <input autoid=\"_is_0\" class='_is_i _is_f ms-font-weight-semibold ms-bg-color-themeLight ms-bg-color-themeLight-hover ms-font-color-neutralPrimary _is_l'/> </div> </form> <button autoid=\"_is_1\" type='button' class='_is_g _is_n _is_i'></button> <button autoid=\"_is_2\" type='button' class='_is_h ms-bg-color-neutralLight _is_i'></button> </div><div>  <div class='_is_c ms-border-color-themeLighter ms-bg-color-themeLight _is_j'></div> <div></div> </div><div> <div class='_is_t ms-bgc-w ms-bcl-tp'> <form action=\"javascript:void(0);\" autocomplete=\"off\"> <div class='_is_r'> <input autoid=\"_is_3\" class='_is_s ms-fwt-sb ms-fcl-np ms-bgc-w ms-bgc-w-h'/> </div> </form>  <button type='button' class='_is_w'></button> <button type='button' class='_is_v'></button> <button autoid=\"_is_4\" type='button' class='_is_u ms-bcl-tp'></button> </div> </div><div>  <div class='_is_o ms-bcl-tp'></div> <div tabindex='-1'></div> </div><div> <div class='_is_x'>  <div autoid=\"_is_5\"></div> <div autoid=\"_is_6\"></div> <div autoid=\"_is_7\"></div> <div autoid=\"_is_8\"></div> <div autoid=\"_is_9\"></div> <div autoid=\"_is_a\"></div> <div></div> <div autoid=\"_is_b\"></div> <div autoid=\"_is_c\"></div> </div> </div><div> <div AriaTabIndex=\"-1\" autoid=\"_is_d\" class='_is_z'> <button type='button' class='_is_C'></button> <div pictureSize=\"40\"> <span class='_is_B'></span> </div> <div class='_is_D'></div> </div> </div><div> <div autoid=\"_is_e\" class='_is_E'> <button autoid=\"_is_f\" type='button' class='_is_H ms-font-m'></button> <span autoid=\"_is_g\" class='_is_F ms-font-weight-regular ms-font-color-neutralSecondary'></span> <div class='_is_I'></div> </div> </div><div> <div autoid=\"_is_h\" class='_is_J'> <button autoid=\"_is_i\" type='button' class='_is_M ms-font-m'></button> <span autoid=\"_is_j\" class='_is_K ms-fwt-r ms-fcl-nsa'></span> <div class='_is_N'></div> </div> </div><div> <div></div>  </div><div> <div autoid=\"_is_k\" class='_is_T'> <span autoid=\"_is_l\" class='_is_S ms-font-weight-semibold ms-font-color-neutralDark'></span> <div></div> <span></span> </div> </div><div> <span class='_is_U ms-fcl-ns ms-fwt-r'></span> </div>";_j.i.a().appendChild(n);return n};_is.a.bh=function(n){return n.e};_is.a.cf=function(n){return n.b};_is.a.Q=function(n){return n.c};_is.a.ce=function(n){return n.a};_is.a.cg=function(n){return n.f};_is.a.ch=function(n){return n.c};_is.a.bR=function(n){return n.a()};_is.a.bm=function(n){return n.hm};_is.a.bi=function(n){return n.b};_is.a.cJ=function(n){return n.jq};_is.a.cF=function(n){return n.iX};_is.a.bx=function(n){return n.fw};_is.a.by=function(n){return n.fx};_is.a.bv=function(n){return n.cW()};_is.a.bs=function(n){return n.dX};_is.a.C=function(n){return n.o};_is.a.bp=function(n){return n.dv};_is.a.B=function(n){return n.k};_is.a.cC=function(n){return n.fl};_is.a.cA=function(n){return n.fk};_is.a.bl=function(n){return n.bl()};_is.a.bt=function(n){return n.dd};_is.a.D=function(n){return n.b};_is.a.p=function(n){return n.X};_is.a.z=function(n){return n.co()};_is.a.v=function(n){return n.ct()};_is.a.w=function(n){return n.dy};_is.a.bo=function(n){return n.eE};_is.a.bq=function(n){return n.dw};_is.a.bw=function(n){return n.fS};_is.a.W=function(n){return n.f()};_is.a.bk=function(n){return n.eh};_is.a.bu=function(n){return n.ft};_is.a.bz=function(n){return n.ek};_is.a.br=function(n){return n.eG};_is.a.bA=function(n){return n.eN};_is.a.N=function(n){return n.d};_is.a.M=function(n){return n.c};_is.a.cB=function(n){return n.hi};_is.a.cH=function(n){return n.kT()};_is.a.bV=function(n){return n.k()};_is.a.bU=function(n){return n.j()};_is.a.ca=function(n){return n.bV()};_is.a.bZ=function(n){return n.w};_is.a.cI=function(n){return n.ja()};_is.a.bn=function(n){return n.bm()};_is.a.cK=function(n){return n.P()};_is.a.cD=function(n){return n.fn};_is.a.bY=function(n){return n.v};_is.a.cG=function(n){return n.iY()};_is.a.f=function(n){return n.o};_is.a.cq=function(n){return n.h()};_is.a.cn=function(n){return n.e()};_is.a.cp=function(n){return n.g()};_is.a.co=function(n){return n.f()};_is.a.cr=function(n){return n.i()};_is.a.cl=function(n){return n.c()};_is.a.cm=function(n){return n.d()};_is.a.ct=function(n){return _is.q.isInstanceOfType(n)?n.C:null};_is.a.cu=function(n){return _is.q.isInstanceOfType(n)?n.B:null};_is.a.cs=function(n){return _is.q.isInstanceOfType(n)?n.z:null};_is.a.j=function(n){return n.p()};_is.a.y=function(n){return n.bq()};_is.a.cv=function(n){return n.a};_is.a.bj=function(n){return n.q};_is.a.bO=function(n){return n.n};_is.a.cw=function(n){return n.K()};_is.a.cO=function(n){return n.c};_is.a.cx=function(n){return n.o()};_is.a.cd=function(n){return n.f};_is.a.cy=function(n){return n.b()};_is.a.bK=function(n){return n.x()};_is.a.cM=function(n){return n.e()};_is.a.cQ=function(n){return n.f()};_is.a.cP=function(n){return n.d};_is.a.cN=function(n){return n.b};_is.a.u=function(n){return n.X};_is.a.bJ=function(n){return _fce.a.isInstanceOfType(n)?n.dP():null};_is.a.bI=function(n){return _fce.a.isInstanceOfType(n)?n.dO():null};_is.a.bF=function(n){return _is.r.isInstanceOfType(n)?n.b:null};_is.a.cE=function(n){return n.hk};_is.a.l=function(n,t){n.bj(t)};_is.a.n=function(n,t){n.k(t)};_is.a.o=function(n,t){n.a=t};_is.a.c=function(n,t){n.a(t)};_is.a.S=function(n,t){n.b(t)};_is.a.cj=function(n,t){n.m(t)};_is.a.R=function(n,t){n.d(t)};_is.a.ci=function(n,t){n.l(t)};_is.a.ck=function(n,t){n.j(t)};_is.a.bS=function(n,t){n.b(t)};_is.a.A=function(n,t){n.a(t)};_is.a.q=function(n,t){n.Q(t)};_is.a.e=function(n,t){n.K(t)};_is.a.m=function(n,t){n.T(t)};_is.a.L=function(n,t){n.bT(t)};_is.a.E=function(n,t){n.p(t)};_is.a.F=function(n,t){n.bc(t)};_is.a.I=function(n,t){n.f=t};_is.a.bC=function(n,t){n.bc(t)};_is.a.H=function(n,t){n.g(t)};_is.a.bB=function(n,t){n.k(t)};_is.a.G=function(n,t){n.n(t)};_is.a.U=function(n,t){n.cy(t)};_is.a.T=function(n,t){n.cx(t)};_is.a.V=function(n,t){n.bP(t)};_is.a.bD=function(n,t){n.g(t)};_is.a.J=function(n,t){n.c(t)};_is.a.K=function(n,t){n.bb(t)};_is.a.x=function(n,t){n.Q(t)};_is.a.g=function(n,t){n.l(t)};_is.a.i=function(n,t){n.m(t)};_is.a.bb=function(n,t){n.k(t)};_is.a.bE=function(n,t){n.ba(t)};_is.a.be=function(n,t){n.p(t)};_is.a.ba=function(n,t){n.j(t)};_is.a.Z=function(n,t){n.bh(t)};_is.a.bd=function(n,t){n.o(t)};_is.a.bf=function(n,t){n.q(t)};_is.a.bc=function(n,t){n.n(t)};_is.a.bg=function(n,t){n.r(t)};_is.a.X=function(n,t){n.Q(t)};_is.a.Y=function(n,t){n.bb(t)};_is.a.P=function(n,t){n.d=t};_is.a.O=function(n,t){n.h(t)};_is.a.bW=function(n,t){n.cz(t)};_is.a.bX=function(n,t){n.dN(t)};_is.a.cc=function(n,t){n.ca(t)};_is.a.cL=function(n,t){n.fn=t};_is.a.cb=function(n,t){n.bM(t)};_is.a.d=function(n,t){n.ba(t)};_is.a.h=function(n,t){n.h(t)};_is.a.bQ=function(n,t){n.s(t)};_is.a.bP=function(n,t){n.ca(t)};_is.a.bL=function(n,t){n.bk(t)};_is.a.cz=function(n,t){n.p(t)};_is.a.bN=function(n,t){n.be(t)};_is.a.bT=function(n,t){n.kO(t)};_is.a.bM=function(n,t){n.u(t)};_is.a.cR=function(n,t){n.a=t};_is.a.t=function(n,t){n.l=t};_is.a.k=function(){_is.a.r||(_is.a.r=new _fc.k);return _is.a.r};_is.a.bG=function(){_is.a.s||(_is.a.s=new _n.y);return _is.a.s};_is.a._I=function(){var n="DateRangeRefinerCategoryView._tid1";new _j.d(n,function(){_is.a.a[n]===undefined&&(_is.a.a[n]=[[[-1,4,null,null,null,"Title",null,_is.a.l,0,null,null,null,_u.R.EW],[-1,4,null,null,null,"Text",null,_is.a.n,0,null,null,null,_u.R.EW],[-1,4,null,null,null,"Data",null,_is.a.o,0,null,null,null,0]],[[-1,4,null,null,null,"Title",null,_is.a.l,0,null,null,null,_nbs.a.aZ],[-1,4,null,null,null,"Text",null,_is.a.n,0,null,null,null,_nbs.a.aZ],[-1,4,null,null,null,"Data",null,_is.a.o,0,null,null,null,1]],[[-1,4,null,null,null,"Title",null,_is.a.l,0,null,null,null,_nbs.a.nO],[-1,4,null,null,null,"Text",null,_is.a.n,0,null,null,null,_nbs.a.nO],[-1,4,null,null,null,"Data",null,_is.a.o,0,null,null,null,2]],[[-1,4,null,null,null,"Title",null,_is.a.l,0,null,null,null,_nbs.a.px],[-1,4,null,null,null,"Text",null,_is.a.n,0,null,null,null,_nbs.a.px],[-1,4,null,null,null,"Data",null,_is.a.o,0,null,null,null,3]],[[-1,4,null,null,null,"Title",null,_is.a.l,0,null,null,null,_nbs.a.Bu],[-1,4,null,null,null,"Text",null,_is.a.n,0,null,null,null,_nbs.a.Bu],[-1,4,null,null,null,"Data",null,_is.a.o,0,null,null,null,4]],[[-1,4,null,null,null,"Text",null,_is.a.c,0,null,null,null,_nbs.a.JE]],[[-1,0,["IsCustomDatePickerEnabled"],[_is.a.bh],null,"IsEnabled",null,_is.a.S,1,null,null,!1],[-1,0,["DateRangeStart"],[_is.a.cf],_is.a.cj,"SelectedDate",_is.a.Q,_is.a.R,2,null,null,null]],[[-1,4,null,null,null,"Text",null,_is.a.c,0,null,null,null,_nbs.a.gs]],[[-1,0,["IsCustomDatePickerEnabled"],[_is.a.bh],null,"IsEnabled",null,_is.a.S,1,null,null,!1],[-1,0,["DateRangeEnd"],[_is.a.ce],_is.a.ci,"SelectedDate",_is.a.Q,_is.a.R,2,null,null,null]]]);var t=_is.a.b.childNodes[0].cloneNode(!0);var i=new _ca.c(t.children[8],_j.b.Instance.a(_bc.a));var r=new _fc.a(t.children[7]);var u=new _ca.c(t.children[6],_j.b.Instance.a(_bc.a));var f=new _fc.a(t.children[5]);var e=new _fce.j(_j.a.a(t,[4,0]));var o=new _fce.j(_j.a.a(t,[3,0]));var s=new _fce.j(_j.a.a(t,[2,0]));var h=new _fce.j(_j.a.a(t,[1,0]));var c=new _fce.j(_j.a.a(t,[0,0]));return new _j.a(t,[c,h,s,o,e,f,u,r,i])},"",_is.W,_fce.i,function(n){return new _fce.i(n)},!1,!0,!1,0,_is.a.a);var t="DateRangeRefinerCategoryView";new _j.d(t,function(){_is.a.a[t]===undefined&&(_is.a.a[t]=[[[-1,5,["IsHidden"],[_is.a.cg],null,"hidden",null,null,0,null,null,null]],[[-1,4,null,null,null,"Text",null,_is.a.c,0,null,null,null,_nbs.a.BE]],[[-1,0,["SelectedDateRange"],[_is.a.ch],_is.a.ck,"SelectedOptionData",_is.a.bR,_is.a.bS,2,null,null,null]]]);var n=_is.a.b.childNodes[1].cloneNode(!0);var i=new _fce.i(_j.a.a(n,[0,1]));i.y("DateRangeRefinerCategoryView._tid1");var r=new _fc.a(_j.a.a(n,[0,0]));var u=new _j.i(n.children[0]);return new _j.a(n,[u,r,i])},"",_is.W,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_is.a.a);var i="InstantSearchButtonsTemplate._tid2";new _j.d(i,function(){_is.a.a[i]===undefined&&(_is.a.a[i]=[[[-1,4,null,null,null,"Id",null,_is.a.A,0,null,null,null,_b.k.f()]],[[-1,4,null,null,null,"Text",null,_is.a.c,0,null,null,null,_u.n.RT],[-1,4,null,null,null,"AriaLabel",null,_is.a.q,0,null,null,null,_u.n.RT]]]);var n=_is.a.b.childNodes[2].cloneNode(!0);var t=new _fc.a(n.children[1]);var r=new _fc.d(n.children[0],_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));return new _j.a(n,[r,t])},"",_db.b,_fc.b,function(n){return new _fc.b(n)},!1,!0,!1,0,_is.a.a);var r="InstantSearchButtonsTemplate._tid3";new _j.d(r,function(){_is.a.a[r]===undefined&&(_is.a.a[r]=[[[-1,4,null,null,null,"Id",null,_is.a.A,0,null,null,null,_b.k.f()]],[[-1,4,null,null,null,"Text",null,_is.a.c,0,null,null,null,_u.n.FQ],[-1,4,null,null,null,"AriaLabel",null,_is.a.q,0,null,null,null,_u.n.FQ]]]);var n=_is.a.b.childNodes[2].cloneNode(!0);var t=new _fc.a(n.children[1]);var i=new _fc.d(n.children[0],_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));return new _j.a(n,[i,t])},"",_db.b,_fc.b,function(n){return new _fc.b(n)},!1,!0,!1,0,_is.a.a);var u="InstantSearchButtonsTemplate";new _j.d(u,function(){_is.a.a[u]===undefined&&(_is.a.a[u]=[[[-1,0,["ImmersiveActions","IsReadingPaneFullScreen"],[_is.a.bm,_is.a.bi],null,"IsHidden",null,_is.a.e,1,_is.a.k(),null,!0],[-1,0,["ShowSearchResultsCommand"],[_is.a.cJ],null,"ClickCommand",null,_is.a.m,1,null,null,null]],[[-1,0,["ImmersiveActions","IsReadingPaneFullScreen"],[_is.a.bm,_is.a.bi],null,"IsHidden",null,_is.a.e,1,null,null,!0],[-1,0,["ExitSearchCommand"],[_is.a.cF],null,"ClickCommand",null,_is.a.m,1,null,null,null]]]);var n=_is.a.b.childNodes[3].cloneNode(!0);var t=new _fc.b(n.children[1]);t.y("InstantSearchButtonsTemplate._tid3");var i=new _fc.b(n.children[0]);i.y("InstantSearchButtonsTemplate._tid2");return new _j.a(n,[i,t])},"",_db.b,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_is.a.a);var f="InstantSearchRefinerView";new _j.d(f,function(){_is.a.a[f]===undefined&&(_is.a.a[f]=[[[-1,5,["InstantSearchRefinerManager","IsHidden"],[_is.a.f,_is.a.cq],null,"_is_y",null,null,0,null,null,null]],[[-1,4,null,null,null,"RefinerCategoryName",null,_is.a.h,0,null,null,null,_nbs.a.Rs],[-1,0,["InstantSearchRefinerManager","FolderRefinerCategoryViewModel"],[_is.a.f,_is.a.cn],null,"DataContext",null,_is.a.d,1,null,null,null]],[[-1,4,null,null,null,"RefinerCategoryName",null,_is.a.h,0,null,null,null,_nbs.a.DV],[-1,0,["InstantSearchRefinerManager","GroupsScopeRefinerCategoryViewModel"],[_is.a.f,_is.a.cp],null,"DataContext",null,_is.a.d,1,null,null,null]],[[-1,4,null,null,null,"RefinerCategoryName",null,_is.a.h,0,null,null,null,_nbs.a.WB],[-1,0,["InstantSearchRefinerManager","FromRefinerCategoryViewModel"],[_is.a.f,_is.a.co],null,"DataContext",null,_is.a.d,1,null,null,null]],[[-1,4,null,null,null,"RefinerCategoryName",null,_is.a.h,0,null,null,null,_nbs.a.fb],[-1,0,["InstantSearchRefinerManager","RecipientsRefinerCategoryViewModel"],[_is.a.f,_is.a.cr],null,"DataContext",null,_is.a.d,1,null,null,null]],[[-1,4,null,null,null,"RefinerCategoryName",null,_is.a.h,0,null,null,null,_nbs.a.CS],[-1,0,["InstantSearchRefinerManager","AttachmentRefinerCategoryViewModel"],[_is.a.f,_is.a.cl],null,"DataContext",null,_is.a.d,1,null,null,null]],[[-1,4,null,null,null,"RefinerCategoryName",null,_is.a.h,0,null,null,null,_nbs.a.BE],[-1,0,["InstantSearchRefinerManager","DateRefinerCategoryViewModel"],[_is.a.f,_is.a.cm],null,"DataContext",null,_is.a.d,1,null,null,null]],[[-1,0,["InstantSearchRefinerManager","CustomDateRangeRefinerCategoryViewModel"],[_is.a.f,_is.a.ct],null,"DataContext",null,_is.a.d,1,null,null,null]],[[-1,4,null,null,null,"RefinerCategoryName",null,_is.a.h,0,null,null,null,_nbs.a.NA],[-1,0,["InstantSearchRefinerManager","HashtagRefinerCategoryViewModel"],[_is.a.f,_is.a.cu],null,"DataContext",null,_is.a.d,1,null,null,null]],[[-1,4,null,null,null,"RefinerCategoryName",null,_is.a.h,0,null,null,null,_nbs.a.Mi],[-1,0,["InstantSearchRefinerManager","ActiontagRefinerCategoryViewModel"],[_is.a.f,_is.a.cs],null,"DataContext",null,_is.a.d,1,null,null,null]]]);var n=_is.a.b.childNodes[8].cloneNode(!0);var e=new _is.k(_j.a.a(n,[0,8]));e.a("RefinerView");var o=new _is.k(_j.a.a(n,[0,7]));o.a("RefinerView");var i=new _j.c(_j.a.a(n,[0,6]));i.L(!0);i.y("DateRangeRefinerCategoryView");var r=new _is.k(_j.a.a(n,[0,5]));r.L(!0);r.a("RefinerView");var s=new _is.k(_j.a.a(n,[0,4]));s.a("RefinerView");var h=new _is.k(_j.a.a(n,[0,3]));h.a("PeopleRefinerView");var c=new _is.k(_j.a.a(n,[0,2]));c.a("PeopleRefinerView");var t=new _is.k(_j.a.a(n,[0,1]));t.b=!0;t.L(!0);t.y("GroupsScopeSearchRefinerCategoryView");t.a("ScopeRefinerView");var u=new _is.k(_j.a.a(n,[0,0]));u.b=!0;u.a("ScopeRefinerView");var l=new _fce.g(n.children[0],_j.b.Instance.a(_j.p),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_j.j));return new _j.a(n,[l,u,t,c,h,s,r,i,o,e])},"",_y.C,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_is.a.a);var e="PeopleRefinerView";new _j.d(e,function(){_is.a.a[e]===undefined&&(_is.a.a[e]=[[[-1,5,["ShowSelected"],[_is.a.j],null,"ms-bg-color-themeLight",null,null,1,null,null,null],[-1,5,["IsItemHoveredAndNotShowSelected"],[_is.a.y],null,"ms-bg-color-neutralLight",null,null,1,null,null,null]],[[-1,4,null,null,null,"ImageId",null,_is.a.g,0,null,null,null,_is.d.a()],[-1,4,null,null,null,"HoveredImageId",null,_is.a.i,0,null,null,null,_is.d.a()],[-1,1,["ShowSelected"],[_is.a.j],null,"IsHidden",null,_is.a.e,1,_is.a.k(),null,!0]],[[-1,0,["Persona"],[_is.a.cv],null,"DataContext",null,_is.a.d,1,null,null,null]]]);var n=_is.a.b.childNodes[9].cloneNode(!0);var t=new _pe.d(_j.a.a(n,[0,1,0]),_j.b.Instance.a(_a.q),_j.b.Instance.a(_pe.e));t.A(-1);t.y("PersonaView.PeopleRefinersPictureAndName");var i=new _fc.b(_j.a.a(n,[0,0]));i.A(-1);var r=new _j.i(n.children[0]);return new _j.a(n,[r,i,t]).l({MainItemContainer:r})},"",_is.bg,_fce.e,function(n){return new _fce.e(n)},!1,!1,!1,0,_is.a.a);var o="RefinerView";new _j.d(o,function(){_is.a.a[o]===undefined&&(_is.a.a[o]=[[[-1,5,["ShowSelected"],[_is.a.j],null,"_is_G ms-bg-color-themeLight",null,null,1,null,null,null],[-1,5,["IsItemHoveredAndNotShowSelected"],[_is.a.y],null,"ms-bg-color-neutralLight",null,null,1,null,null,null]],[[-1,4,null,null,null,"ImageId",null,_is.a.g,0,null,null,null,_is.d.a()],[-1,4,null,null,null,"HoveredImageId",null,_is.a.i,0,null,null,null,_is.d.a()],[-1,1,["ShowSelected"],[_is.a.j],null,"IsHidden",null,_is.a.e,1,_is.a.k(),null,!0]],[[-1,0,["DisplayString"],[_is.a.bj],null,"Text",null,_is.a.c,1,null,null,null]]]);var n=_is.a.b.childNodes[10].cloneNode(!0);var i=new _fc.a(_j.a.a(n,[0,1]));i.A(-1);var r=new _fc.b(_j.a.a(n,[0,0]));r.A(-1);var t=new _j.i(n.children[0]);t.A(-1);t.E(13);return new _j.a(n,[t,r,i]).l({MainItemContainer:t})},"",_is.m,_fce.e,function(n){return new _fce.e(n)},!1,!1,!1,0,_is.a.a);var s="ScopeRefinerView.FolderScopeRefinerView";new _j.d(s,function(){_is.a.a[s]===undefined&&(_is.a.a[s]=[[[-1,5,["ShowSelected"],[_is.a.j],null,"_is_L ms-bgc-tl",null,null,1,null,null,null],[-1,5,["IsItemHoveredAndNotShowSelected"],[_is.a.y],null,"ms-bgc-nl",null,null,1,null,null,null]],[[-1,4,null,null,null,"ImageId",null,_is.a.g,0,null,null,null,_is.d.a()],[-1,4,null,null,null,"HoveredImageId",null,_is.a.i,0,null,null,null,_is.d.a()],[-1,1,["ShowSelected"],[_is.a.j],null,"IsHidden",null,_is.a.e,1,_is.a.k(),null,!0]],[[-1,0,["DisplayString"],[_is.a.bj],null,"Text",null,_is.a.c,1,null,null,null]]]);var n=_is.a.b.childNodes[11].cloneNode(!0);var i=new _fc.a(_j.a.a(n,[0,1]));i.A(-1);var r=new _fc.b(_j.a.a(n,[0,0]));r.A(-1);var t=new _j.i(n.children[0]);t.A(-1);t.E(13);return new _j.a(n,[t,r,i])},"",_is.f,_fce.e,function(n){return new _fce.e(n)},!1,!1,!1,0,_is.a.a);var h="ScopeRefinerView";new _j.d(h,function(){_is.a.a[h]===undefined&&(_is.a.a[h]=[[[-1,1,["ShowSelected"],[_is.a.j],null,"ShowSelected",null,_is.a.bQ,1,null,null,!1],[-1,1,["IsItemHovered"],[_is.a.bO],null,"IsItemHovered",null,_is.a.bP,1,null,null,!1]]]);var n=_is.a.b.childNodes[12].cloneNode(!0);var t=new _is.bC(n.children[0]);return new _j.a(n,[t]).l({MainItemContainer:t})},"",_is.g,_fce.e,function(n){return new _fce.e(n)},!1,!1,!1,0,_is.a.a);var c="SearchRefinerCategoryView._tid6";new _j.d(c,function(){_is.a.a[c]===undefined&&(_is.a.a[c]=[null]);var n=_is.a.b.childNodes[12].cloneNode(!0);var t=new _fce.d(n.children[0]);return new _j.a(n,[t]).l({ListPanel:t})},"",_is.i,_is.r,function(n){return new _is.r(n,_j.b.Instance.a(_y.a))},!1,!0,!1,0,_is.a.a);var l="SearchRefinerCategoryView";new _j.d(l,function(){_is.a.a[l]===undefined&&(_is.a.a[l]=[[[-1,0,["NoRefinersAvailable"],[_is.a.cw],null,"IsHidden",null,_is.a.e,1,null,null,!0]],[[-1,1,["RefinerCategoryName"],[_is.a.cO],null,"Text",null,_is.a.c,1,null,null,null]],[[-1,1,["AriaLabelValue"],[_is.a.cM],null,"AriaLabel",null,_is.a.q,1,null,null,null],[-1,1,["SearchRefinerAriaId"],[_is.a.cQ],null,"AriaDescribedBy",null,_is.a.bT,1,_is.a.bG(),"descriptionFilter",null],[-1,1,["RefinerValueTemplateId"],[_is.a.cP],null,"DataTemplateId",null,_is.a.bM,0,null,null,null],[-1,1,["BehaveAsRadioButton"],[_is.a.cN],null,"BehaveAsRadioButton",null,_is.a.cR,1,null,null,!1],[-1,0,["RefinerValues","ObservableCollection"],[_is.a.cx,_is.a.cd],null,"DataSource",null,_is.a.bL,1,null,null,null],[-1,0,["SelectedRefiner"],[_is.a.cy],_is.a.cz,"SelectedItem",_is.a.bK,_is.a.bN,2,null,null,null]],[[-1,4,null,null,null,"Text",null,_is.a.c,0,null,null,null,_u.n.H]]]);var t=_is.a.b.childNodes[13].cloneNode(!0);var i=new _fc.a(_j.a.a(t,[0,2]));i.bg("descriptionFilter");i.K(!0);var n=new _is.r(_j.a.a(t,[0,1]),_j.b.Instance.a(_y.a));n.cx(!0);n.E(28);n.cg(13);n.bc=!0;n.ko(!1);var o=new _fc.g;var r=new _fc.c;r.W(_j.f.a(["ContextParent","FocusOnPreviousItemCommand"],[_is.a.u,_is.a.bJ],null,"Command",null,_is.a.t,1));r.j("UPARROW");var u=new _fc.c;u.W(_j.f.a(["ContextParent","FocusOnNextItemCommand"],[_is.a.u,_is.a.bI],null,"Command",null,_is.a.t,1));u.j("DOWNARROW");var f=new _fc.c;f.W(_j.f.a(["ContextParent","ToggleActiveItemSelectionCommand"],[_is.a.u,_is.a.bF],null,"Command",null,_is.a.t,1));f.j("SPACE");var e=new _fc.c;e.W(_j.f.a(["ContextParent","ToggleActiveItemSelectionCommand"],[_is.a.u,_is.a.bF],null,"Command",null,_is.a.t,1));e.j("ENTER");o.a([r,u,f,e]);n.C([o]);n.y("SearchRefinerCategoryView._tid6");var s=new _fc.a(_j.a.a(t,[0,0]));var h=new _j.i(t.children[0]);return new _j.a(t,[h,s,n,i]).l({RefinerValuesList:n})},"",_is.i,_is.k,function(n){return new _is.k(n)},!1,!1,!1,0,_is.a.a);var a="SearchResultsHeader";new _j.d(a,function(){_is.a.a[a]===undefined&&(_is.a.a[a]=[[[-1,0,["DisplayedSearchFolderScope"],[_is.a.cE],null,"Text",null,_is.a.c,1,null,null,null]]]);var n=_is.a.b.childNodes[14].cloneNode(!0);var t=new _fc.a(n.children[0]);return new _j.a(n,[t])},"",_db.b,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_is.a.a)};_is.W.registerClass("_is.W",_j.R);_is.i.registerClass("_is.i",_a.bv,ISearchRefinerCategoryViewModel,_j.bs,Sys.IDisposable);_is.bP.registerClass("_is.bP",_is.i,_xt.o,ISearchRefinerCategoryViewModel,_j.bs,Sys.IDisposable);_is.bx.registerClass("_is.bx",_is.bP);_is.m.registerClass("_is.m",_a.bv,IRefinerViewModel,_j.bs,Sys.IDisposable);_is.g.registerClass("_is.g",_is.m);_is.f.registerClass("_is.f",_is.g);_is.u.registerClass("_is.u",null,_is.Z);_is.by.registerClass("_is.by",null,_y.cz);_is.q.registerClass("_is.q",_j.R,IInstantSearchRefinerManager);_is.G.registerClass("_is.G",_a.bv,_y.iw);_is.bz.registerClass("_is.bz",_y.lx,_y.fa,_y.lk,_j.bs,Sys.IDisposable);_is.bA.registerClass("_is.bA",_j.R,_bc.be);_is.bg.registerClass("_is.bg",_is.m);_is.bh.registerClass("_is.bh",_j.R,_y.iv,Sys.IDisposable);_is.H.registerClass("_is.H",_j.R,_y.lp,_j.bs,Sys.IDisposable);_is.X.registerClass("_is.X",_ff.e,0);_is.h.registerClass("_is.h",_ff.e,0);_is.J.registerClass("_is.J",_ff.e);_is.K.registerClass("_is.K",_ff.e,0);_is.bk.registerClass("_is.bk",_g.hD,0,0);_is.C.registerClass("_is.C",_ff.e,0);_is.I.registerClass("_is.I",_ff.e,0);_is.bo.registerClass("_is.bo",_h.fG);_is.n.registerClass("_is.n",_h.fG);_is.bp.registerClass("_is.bp",_is.n);_is.t.registerClass("_is.t",null,_is.R);_is.bJ.registerClass("_is.bJ",_h.fG,_is.bL,IActionBase,_h.bO);_is.e.registerClass("_is.e",_is.bJ,_is.bL,IActionBase,_h.bO);_is.E.registerClass("_is.E",_is.bJ);_is.z.registerClass("_is.z",_h.fG);_is.F.registerClass("_is.F",_h.fG);_is.V.registerClass("_is.V",_h.fG,IActionBase,_a.fD,_h.bO);_is.bs.registerClass("_is.bs");_is.bb.registerClass("_is.bb");_is.bu.registerClass("_is.bu");_is.bO.d.registerClass("_is.bO.d",_is.X);_is.bO.b.registerClass("_is.bO.b",_is.X);_is.bO.e.registerClass("_is.bO.e",_is.X);_is.bO.f.registerClass("_is.bO.f",_is.X);_is.bO.c.registerClass("_is.bO.c",_is.X);_is.bO.g.registerClass("_is.bO.g",_is.X);_is.p.registerClass("_is.p",_j.R,_h.fr);_is.p.b.registerClass("_is.p.b",_j.R,_h.fh,_j.bs,Sys.IDisposable);_is.bw.registerClass("_is.bw",null,_h.fj);_is.bn.registerClass("_is.bn",_h.fG);_is.br.registerClass("_is.br",_j.R,_h.fi);_is.N.registerClass("_is.N",_is.br,_h.ff,_h.fi);_is.br.a.registerClass("_is.br.a",_j.R,_h.fh,_j.bs,Sys.IDisposable);_is.br.b.registerClass("_is.br.b");_is.c.registerClass("_is.c",null,_h.fj);_is.S.registerClass("_is.S",_j.R,_h.fk,_j.bs,Sys.IDisposable);_is.bM.registerClass("_is.bM",_j.R,_j.bs,Sys.IDisposable);_is.o.registerClass("_is.o",_is.bM);_is.A.registerClass("_is.A",_is.bM);_is.bc.registerClass("_is.bc",_is.bM);_is.U.registerClass("_is.U",_j.R,_h.fz,_j.bs,Sys.IDisposable,_h.bM);_is.U.a.registerClass("_is.U.a",null,_h.fD);_is.bt.registerClass("_is.bt",_is.U);_is.bN.registerClass("_is.bN",_is.U,_h.G,_h.fz,_j.bs,Sys.IDisposable);_is.bd.registerClass("_is.bd",_is.bN,_h.D,_h.G,_h.fz,_j.bs,Sys.IDisposable);_is.be.registerClass("_is.be",_is.bN,_h.E,_h.G,_h.fz,_j.bs,Sys.IDisposable);_is.b.registerClass("_is.b",_gg.EG,_a.fK,_a.fD);_is.k.registerClass("_is.k",_j.c);_is.r.registerClass("_is.r",_fce.a);_is.bC.registerClass("_is.bC",_fce.e);InstantSearchComponent.registerClass("InstantSearchComponent",null,_a.jR,_j.ce);_is.D.registerClass("_is.D");_is.L.registerClass("_is.L",_is.e);_is.s.registerClass("_is.s");_is.M.registerClass("_is.M");_is.q.a.b=new _is.m(_u.R.DN,0,null,!1,null);_is.q.a.a=new _is.m(_u.R.Gn,0,null,!1,null);_is.q.a.c=new _is.m(_u.R.RR,0,null,!1,null);_is.G.a=_db.b.b+"{0}"+_db.b.c+"{1}";_is.H.a=_a.a.B;_is.X._dataContractName="SubstrateSearchEvent:#Exchange";_is.h._dataContractName="SubstrateSearchEventAttribute:#Exchange";_is.J._dataContractName="SubstrateSearchEventsEnvelope:#Exchange";_is.K._dataContractName="SubstrateSearchEventsGroup:#Exchange";_is.C._dataContractName="GetAutoSuggestionsRequest:#Exchange";_is.I._dataContractName="GetAutoSuggestionsResponse:#Exchange";_is.n.a="V2016_06_15";_is.w.a="|";_is.P.a=[1,4,2];_is.t.a=[1,2];_is.e.b="00000000-0000-0000-0000-000000000000";_is.e.c={"1":"Text","2":"People"};_is.e.a=_a.a.t;_is.Q.a=[1,4];_is.z.b=_a.a.cx;_is.z.a=[""];_is.V.a=_a.a.cx;_is.bO.a.g="latency";_is.bO.a.e="status";_is.bO.a.h="rendered";_is.bO.a.f="renderinglatency";_is.bO.a.c="id";_is.bO.a.b="rank";_is.bO.a.a="localtime";_is.bO.a.d="conversationid";_is.bO.d.a="responsereceived";_is.bO.b.a="entityclicked";_is.bO.e.a="searchdone";_is.bO.f.a="sessionend";_is.bO.c.a="requestcontext";_is.l.a="00000000-0000-0000-0000-000000000000";_is.l.c=_a.a.cx;_is.l.b=1e4;_is.p.c=[[0,25],[25,50],[75,75],[150,100]];_is.p.b.a=["AreAllSearchResultsAvailable","IsSearchInProgress","IsSearchError"];_is.N.a=_a.a.bc;_is.br.a.a=["AreAllSearchResultsAvailable","IsSearchInProgress","IsSearchError"];_is.U.b=new _g.l("InstantSearch");_is.U.a.a=0;_is.b.i="Warmup";_is.b.e="GetSuggestions";_is.b.f="GetSuggestionsPrimer";_is.b.h="MailItemsSearch";_is.b.g="MailConversationsSearch";_is.b.d="CalendarSearch";_is.b.c=0;_is.b.b=0;InstantSearchComponent.$$cctor();_is.s.a="/autosuggest/api/v1/suggestions";_is.a.b=_is.a.bH();_is.a.r=null;_is.a.s=null;_is.a.a={};_is.a.$$cctor();
window.scriptsLoaded['microsoft.owa.core.instantsearch.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.core.instantsearch.js'] = (new Date()).getTime();
