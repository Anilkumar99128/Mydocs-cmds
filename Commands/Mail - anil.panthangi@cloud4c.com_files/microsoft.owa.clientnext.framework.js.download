window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.clientnext.framework.js'] = (new Date()).getTime();
Type.registerNamespace("_cnf");_cnf.b=function(n,t,i){var r={resourcesBaseUrl:t.w(),userLanguage:i.c().bD.UserLanguage,timeZone:i.a().bD.TimeZone};OwaNext.application.bootstrap(r)};function ClientNextFrameworkComponent(){}ClientNextFrameworkComponent.$$cctor=function(){_a.t.a().a(ClientNextFrameworkComponent)};ClientNextFrameworkComponent.prototype={b:function(n,t,i){var r=this;n.b(_cnf.c,function(){return new _cnf.c(n.a(_a.f))}).a();var u=this;n.b(_cnf.a,function(){return new _cnf.a(n.a(_j.j),n.a(_cnf.c),n.a(_y.a),n.a(_a.f))}).a();var f=this;n.b(_cnf.e,function(){return new _cnf.e(n.c(_h.cX))}).a();var e=this;n.b(_cnf.d,function(){return new _cnf.d(_a.a.cU)}).a();var o=this;n.b(_cnf.b,function(){return new _cnf.b(n.a(_y.a),i,n.a(_g.h))}).a()},a:function(){return[new _j.y(_cnf.d,0,-1),new _j.y(_cnf.b,0,-1)]}};_cnf.e=function(n){this.c=Function.createDelegate(this,this.d);this.b=n;OwaNext.initializeActionDispatcher(this.c)};_cnf.e.prototype={b:null,a:null,d:function(n,t,i){if(!this.a){var r=this;this.b.a(function(u){r.a=u;r.d(n,t,i)});return}var u=this.a.a(n,i,t,!0);_a.g.a.a(u)}};_cnf.d=function(n){this.b=Function.createDelegate(this,this.g);this.a=Function.createDelegate(this,this.e);this.c=Function.createDelegate(this,this.h);this.d=n;OwaNext.application.initializeCtq(this.c,this.a,this.b,this.f())};_cnf.d.prototype={d:null,h:function(n,t){t=t?t:_a.a.cU;return _a.c.b(t,n,!1,null)},e:function(n,t,i,r){n.m=t;n.n=i;n.p=r;_a.c.a(n)},g:function(n,t,i){i=i?i:_a.a.cU;_a.c.c(i,n,t,0)},f:function(){var n={};n.calendar=_a.a.b;n.extensibility=_a.a.i;n.oxford=_a.a.cU;return n}};_cnf.c=function(n){this.a=n.a().jL().Enabled};_cnf.c.prototype={a:!1,b:function(n,t){this.a&&OwaNext.application.raiseEvent(n,t)}};_cnf.a=function(n,t,i,r){this.d=Function.createDelegate(this,this.l);this.b={};this.a=t;this.f=r;this.c=i;n.b(_h.dj,this.d)};_cnf.a.prototype={a:null,f:null,c:null,l:function(n){var t={};t.queryKey=n.a.c().a();t.folderIdObject=n.a.e();this.a.b("TABLE_ADDED",t);var i=this;n.a.a().e(function(t,r){i.k(n.a.c().a(),r)})},k:function(n,t){var r=!1;var u=this.i(n);var i={};i.queryKey=n;i.action=_j.NotifyCollectionChangedAction.toString(t.c);i.changeIndex=t.d;i.toIndex=t.e;var f,e;i.oldItems=(e=this.g(t.b,f={val:r},u,!1),r=f.val,e);var o,s;i.newItems=(s=this.g(t.a,o={val:r},u,!0),r=o.val,s);r||this.a.b("TABLE_COLLECTION_CHANGED",i)},g:function(n,t,i,r){if(!n)return null;for(var e=[],o=n,s=o.length,f=0;f<s;++f){var u=o[f];if(_g.p.isInstanceOfType(u)){e.push(this.e(u));r?u.I(i):u.F(i)}else{t.val=!0;return null}}return e},i:function(n){if(!(n in this.b)){var t=this;this.b[n]=function(i,r){if(Array.indexOf(_cnf.a.a,r)>-1){var u={item:t.e(i),queryKey:n};t.a.b("ITEM_CHANGED",u)}}}return this.b[n]},h:function(n){var t;var i=!0;t=i&&!n.bi()?n.m():n.h();return this.c.a()==="Mouse"?(new _b.U).a(t,null):(new _b.M).a(t,null)},j:function(n){return _h.bg.b(n,!1)},e:function(n){var i=0;switch(n.K()){case"Complete":i=1;break;case"Flagged":i=2;break;case"NotFlagged":i=0;break}var r=0;switch(n.be()){case"Low":r=0;break;case"Normal":r=1;break;case"High":r=2;break}var f=this.j(n);var u=null;if(n&&n.m()){u=new Date(n.m().n.getTime());u.setMinutes(n.m().n.getMinutes()+n.m().n.getTimezoneOffset())}var t={};t.conversationObject=n;t.topPropertyIconsToShow=f.c(3);t.smallIcon=f.b();t.dateTimeToDisplay=this.h(n);t.lastDeliveryOrRenewTime=u;t.importance=r;t.smimeType=n.bz();t.conversationId=n.bD.ConversationId.Id;t.unreadCount=n.bD.UnreadCount;t.conversationTopic=n.bD.ConversationTopic;t.globalMessageCount=n.bD.GlobalMessageCount;t.messageCount=n.bD.MessageCount;t.preview=n.bD.Preview;t.uniqueRecipients=n.q()?n.q().e():[];t.uniqueSenders=n.g()?n.g().e():[];t.flagStatus=i;t.isSmimeClass=n.bx();t.isPinned=n?n.z:!1;return t}};_cnf.b.registerClass("_cnf.b");ClientNextFrameworkComponent.registerClass("ClientNextFrameworkComponent",null,_a.jR,_j.ce);_cnf.e.registerClass("_cnf.e");_cnf.d.registerClass("_cnf.d");_cnf.c.registerClass("_cnf.c");_cnf.a.registerClass("_cnf.a");ClientNextFrameworkComponent.$$cctor();_cnf.a.a=["ConversationId","ConversationTopic","FlagStatus","GlobalMessageCount","Importance","IsPinned","LastDeliveryTime","LastDeliveryOrRenewTime","Preview","UniqueRecipients","UniqueSenders","UnreadCount"];
window.scriptsLoaded['microsoft.owa.clientnext.framework.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.clientnext.framework.js'] = (new Date()).getTime();
